<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления | Debuntarium</title>
<meta name="description" content="Описание установки на Cloudera Hadoop узел экземпляра Airflow второй версии с назначением ролей из FreeIPA.
">
<meta property="og:url" content="https://debuntu.ru/manuals/bigdata/apacheairflow/ustanovka-apache-airflow-2-freeipa-apache-hadoop-scenarii-udaleniya/">
  <meta property="og:site_name" content="Debuntarium">
  <meta property="og:title" content="Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления">
  <meta property="og:description" content="Описание установки на Cloudera Hadoop узел экземпляра Airflow второй версии с назначением ролей из FreeIPA.">
  <meta property="og:locale" content="ru_ru">
  <meta property="og:type" content="article">
    <meta property="article:section" content="manuals">
    <meta property="article:published_time" content="2021-02-23T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-02-23T00:00:00+00:00">
    <meta property="article:tag" content="Apache Airflow">
    <meta property="article:tag" content="FreeIPA">
    <meta property="article:tag" content="Apache Hadoop">
    <meta property="article:tag" content="CentOS">
    <meta property="article:tag" content="CentOS 7">

  <meta itemprop="name" content="Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления">
  <meta itemprop="description" content="Описание установки на Cloudera Hadoop узел экземпляра Airflow второй версии с назначением ролей из FreeIPA.">
  <meta itemprop="datePublished" content="2021-02-23T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-02-23T00:00:00+00:00">
  <meta itemprop="wordCount" content="3840">
  <meta itemprop="keywords" content="Apache Airflow,FreeIPA,Apache Hadoop,CentOS,CentOS 7">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления">
  <meta name="twitter:description" content="Описание установки на Cloudera Hadoop узел экземпляра Airflow второй версии с назначением ролей из FreeIPA.">




<link rel="preload" href="/scss/main.min.5118d334f4d49e78b43432d75232dda13144ff70fc9d784048f9c31c8751ea0f.css" as="style">
<link href="/scss/main.min.5118d334f4d49e78b43432d75232dda13144ff70fc9d784048f9c31c8751ea0f.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1HVBCPETY0"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-1HVBCPETY0');
}
</script>
  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">Debuntarium</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/n/"><span>Заметки</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/manuals/"><span>Инструкции</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/refbooks/"><span>Справочники</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/a/"><span>Статьи</span></a>
      </li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-manuals-li">
  <a href="/manuals/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-manuals"><span class="">Инструкции</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualskubernetes-li">
  <a href="/manuals/kubernetes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualskubernetes"><span class="">Kubernetes</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm-li">
  <a href="/manuals/kubernetes/obshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm"><span class="">Общая инструкция по установке K8s with High Availability and Stacked Etcd в изолированной среде с помощью kubeadm</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetes-li">
  <a href="/manuals/kubernetes/obshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm/10._k8s._podgotovka_vsekh_khostov_k_ustanovke_kubernetes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetes"><span class="">10. K8s. Подготовка всех хостов к установке Kubernetes&#39;а</span></a>
  <ul class="ul-4 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetesotklyucheniye_swap_na_vsekh_nodakh-li">
  <a href="/manuals/kubernetes/obshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm/10._k8s._podgotovka_vsekh_khostov_k_ustanovke_kubernetes/otklyucheniye_swap_na_vsekh_nodakh/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetesotklyucheniye_swap_na_vsekh_nodakh"><span class="">10. Отключение swap на всех нодах</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetesustanovka-containerd-li">
  <a href="/manuals/kubernetes/obshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm/10._k8s._podgotovka_vsekh_khostov_k_ustanovke_kubernetes/ustanovka-containerd/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualskubernetesobshchaya_instruktsiya_po_ustanovke_k8s_s_high_availability_i_stacked_etcd_v_izolirovannoy_srede_s_pomoshchyu_kubeadm10_k8s_podgotovka_vsekh_khostov_k_ustanovke_kubernetesustanovka-containerd"><span class="">30. Установка containerd</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsdatabases-li">
  <a href="/manuals/databases/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsdatabases"><span class="">DataBases</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsdatabasespostgresql-li">
  <a href="/manuals/databases/postgresql/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsdatabasespostgresql"><span class="">PostgreSQL</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsdatabasespostgresqlpostgresql14-centos7-ustanovka-li">
  <a href="/manuals/databases/postgresql/postgresql14-centos7-ustanovka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsdatabasespostgresqlpostgresql14-centos7-ustanovka"><span class="">PostgreSQL14. CentOS7. Установка</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-manualsbigdata-li">
  <a href="/manuals/bigdata/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdata"><span class="">BigData</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataapacheatlas-li">
  <a href="/manuals/bigdata/apacheatlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataapacheatlas"><span class="">Apache Atlas</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlassborka-apache-atlas-220-dlya-cloudera-cdh-632-li">
  <a href="/manuals/bigdata/apacheatlas/sborka-apache-atlas-2.2.0-dlya-cloudera-cdh-6.3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlassborka-apache-atlas-220-dlya-cloudera-cdh-632"><span class="">Сборка Apache Atlas 2.2.0 для Cloudera CDH 6.3.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlassborka-apache-atlas-2-1-0-dlya-cloudera-cdh-6-3-2-li">
  <a href="/manuals/bigdata/apacheatlas/sborka-apache-atlas-2-1-0-dlya-cloudera-cdh-6-3-2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlassborka-apache-atlas-2-1-0-dlya-cloudera-cdh-6-3-2"><span class="">Сборка Apache Atlas 2.1.0 для Cloudera CDH 6.3.2 (устарело)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoop-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0-v-arenadata-hadoop/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoop"><span class="">Установка Apache Atlas 2.2.0 в ArenaData Hadoop</span></a>
  <ul class="ul-4 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoopapache-atlas-uninstall-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0-v-arenadata-hadoop/apache-atlas-uninstall/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoopapache-atlas-uninstall"><span class="">00. Удаление Apache Atlas</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoopvazhnyye-zamechaniya-atlas-v-adh-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0-v-arenadata-hadoop/vazhnyye-zamechaniya-atlas-v-adh/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadoopvazhnyye-zamechaniya-atlas-v-adh"><span class="">01. Важные замечания относительно Atlas &#43; ADH </span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadooppodgotovitelnyye_raboty_v_domene_i_na_khoste-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0-v-arenadata-hadoop/podgotovitelnyye_raboty_v_domene_i_na_khoste/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadooppodgotovitelnyye_raboty_v_domene_i_na_khoste"><span class="">02. Подготовительные работы в домене и на хосте </span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadooppodgotovka-sluzhb-adh-klastera-k-razvortyvaniyu-atlasa-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0-v-arenadata-hadoop/podgotovka-sluzhb-adh-klastera-k-razvortyvaniyu-atlasa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-v-arenadata-hadooppodgotovka-sluzhb-adh-klastera-k-razvortyvaniyu-atlasa"><span class="">03. Подготовка служб ADH-кластера к развёртыванию Atlas&#39;а</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220"><span class="">Установка Apache Atlas 2.2.0</span></a>
  <ul class="ul-4 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220podgotovitelnyye-raboty-dlya-ustanovki-atlas-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/podgotovitelnyye-raboty-dlya-ustanovki-atlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220podgotovitelnyye-raboty-dlya-ustanovki-atlas"><span class="">01. Подготовительные работы для установки Atlas&#39;а</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220podgotovka-sluzhb-hadoop-klastera-k-razvortyvaniyu-atlas-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/podgotovka-sluzhb-hadoop-klastera-k-razvortyvaniyu-atlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220podgotovka-sluzhb-hadoop-klastera-k-razvortyvaniyu-atlas"><span class="">02. Подготовка служб Hadoop-кластера к развёртыванию Atlas&#39;а</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220vybor-i-podgotovka-poiskovogo-dvizhka-dlya-ispolzovaniya-atlas-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/vybor-i-podgotovka-poiskovogo-dvizhka-dlya-ispolzovaniya-atlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220vybor-i-podgotovka-poiskovogo-dvizhka-dlya-ispolzovaniya-atlas"><span class="">03. Выбор и подготовка поискового движка для использования Atlas&#39;ом</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220raspakovka-i-nastroyka-apache-atlas-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/raspakovka-i-nastroyka-apache-atlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220raspakovka-i-nastroyka-apache-atlas"><span class="">04. Распаковка и настройка Apache Atlas</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-apache-hive-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/zabros-hook-v-apache-hive/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-apache-hive"><span class="">05. 🎣 Заброс Hook&#39;а в Apache Hive</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-apache-hbase-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/zabros-hook-v-apache-hbase/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-apache-hbase"><span class="">06. 🎣 Заброс Hook&#39;а в Apache HBase</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-spark-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/zabros-hook-v-spark/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220zabros-hook-v-spark"><span class="">07. 🎣 Заброс Hook&#39;а в Spark (в разработке)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervyy-zapusk-apache-atlas-i-yego-otladka-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/pervyy-zapusk-apache-atlas-i-yego-otladka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervyy-zapusk-apache-atlas-i-yego-otladka"><span class="">08. Первый запуск Apache Atlas и его отладка при необходимости</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervonachalnyy-import-soderzhimogo-hive-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/pervonachalnyy-import-soderzhimogo-hive/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervonachalnyy-import-soderzhimogo-hive"><span class="">10. Первоначальный импорт содержимого Hive</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervonachalnyy-import-soderzhimogo-hbase-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/pervonachalnyy-import-soderzhimogo-hbase/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220pervonachalnyy-import-soderzhimogo-hbase"><span class="">11. Первоначальный импорт содержимого HBase</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220testirovaniye-rabotosposobnosti-apache-atlas-li">
  <a href="/manuals/bigdata/apacheatlas/ustanovka-apache-atlas-2.2.0/testirovaniye-rabotosposobnosti-apache-atlas/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheatlasustanovka-apache-atlas-220testirovaniye-rabotosposobnosti-apache-atlas"><span class="">20. 🔬 Тестирование работоспособности Apache Atlas</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipa-li">
  <a href="/manuals/bigdata/ustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipa"><span class="">Установка ArenaData Hadoop с TLS и Kerberos на основе FreeIPA</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipavazhnyye-zamechaniya-li">
  <a href="/manuals/bigdata/ustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipa/vazhnyye-zamechaniya/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-arenadata-hadoop-s-tls-i-kerberos-na-osnove-freeipavazhnyye-zamechaniya"><span class="">01. Важные замечания</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipa-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipa"><span class="">Установка Cloudera CDH 6.3.2 с TLS и Kerberos на основе FreeIPA</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipapodgotovka-k-ustanovke-klastera-cloudera-cdh-6-32-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/podgotovka-k-ustanovke-klastera-cloudera-cdh-6-3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipapodgotovka-k-ustanovke-klastera-cloudera-cdh-6-32"><span class="">01. Подготовка к установке кластера Cloudera CDH 6.3.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-cloudera-manager-6-31-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/ustanovka-cloudera-manager-6-3.1/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-cloudera-manager-6-31"><span class="">02. Установка Cloudera Manager 6.3.1</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-osnovnykh-komponentov-cloudera-cdh-632-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/ustanovka-osnovnykh-komponentov-cloudera-cdh-6.3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-osnovnykh-komponentov-cloudera-cdh-632"><span class="">03. Установка основных компонентов Cloudera CDH 6.3.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-osnovnykh-komponentov-cloudera-cdh-632-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/ustanovka-osnovnykh-komponentov-cloudera-cdh-6.3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaustanovka-osnovnykh-komponentov-cloudera-cdh-632"><span class="">03. Установка основных компонентов Cloudera CDH 6.3.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaposle-ustanovki-osnovnykh-komponentov-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/posle-ustanovki-osnovnykh-komponentov/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaposle-ustanovki-osnovnykh-komponentov"><span class="">04. После установки основных компонентов</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipanastroyka-tls-dlya-cloudera-manager-server-i-yego-agentov-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/nastroyka-tls-dlya-cloudera-manager-server-i-yego-agentov/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipanastroyka-tls-dlya-cloudera-manager-server-i-yego-agentov"><span class="">10. Настройка TLS для Cloudera Manager Server и его агентов</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipanastroyka-tls-dlya-hdfs-i-yarn-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/nastroyka-tls-dlya-hdfs-i-yarn/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipanastroyka-tls-dlya-hdfs-i-yarn"><span class="">11. Настройка TLS для HDFS и YARN</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipavklyucheniye-kerberos-v-cloudera-cdh-632-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/vklyucheniye-kerberos-v-cloudera-cdh-6.3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipavklyucheniye-kerberos-v-cloudera-cdh-632"><span class="">12. Включение Kerberos в Cloudera CDH 6.3.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipazookeeper-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/zookeeper-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipazookeeper-nastroyka"><span class="">13. Zookeeper. Настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahdfs-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/hdfs-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahdfs-nastroyka"><span class="">14. HDFS. Настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipayarn-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/yarn-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipayarn-nastroyka"><span class="">15. YARN. Настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahbase-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/hbase-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahbase-ustanovka-i-nastroyka"><span class="">16. HBase. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaspark-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/spark-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipaspark-ustanovka-i-nastroyka"><span class="">17. Spark. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahive-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/hive-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahive-ustanovka-i-nastroyka"><span class="">18. Hive. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipasentry-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/sentry-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipasentry-ustanovka-i-nastroyka"><span class="">19. Sentry. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahue-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/hue-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipahue-ustanovka-i-nastroyka"><span class="">20. Hue. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipasolr-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/solr-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipasolr-ustanovka-i-nastroyka"><span class="">21. Solr. Установка и настройка</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipakafka-ustanovka-i-nastroyka-li">
  <a href="/manuals/bigdata/ustanovka-cloudera-cdh-6.3.2-s-tls-i-kerberos-na-osnove-freeipa/kafka-ustanovka-i-nastroyka/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataustanovka-cloudera-cdh-632-s-tls-i-kerberos-na-osnove-freeipakafka-ustanovka-i-nastroyka"><span class="">22. Kafka. Установка и настройка</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsbigdataapachezookeeper-li">
  <a href="/manuals/bigdata/apachezookeeper/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataapachezookeeper"><span class="">Apache ZooKeeper</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapachezookeeperpoluchenie-prav-superusera-v-zookeepere-cloudera-cdh-6-32-li">
  <a href="/manuals/bigdata/apachezookeeper/poluchenie-prav-superusera-v-zookeepere-cloudera-cdh-6-3.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapachezookeeperpoluchenie-prav-superusera-v-zookeepere-cloudera-cdh-6-32"><span class="">Получение прав Superuser&#39;а в ZooKeeper&#39;е Cloudera CDH 6.3.2</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-manualsbigdataapacheairflow-li">
  <a href="/manuals/bigdata/apacheairflow/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsbigdataapacheairflow"><span class="">Apache Airflow</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-manualsbigdataapacheairflowustanovka-apache-airflow-2-freeipa-apache-hadoop-scenarii-udaleniya-li">
  <a href="/manuals/bigdata/apacheairflow/ustanovka-apache-airflow-2-freeipa-apache-hadoop-scenarii-udaleniya/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheairflowustanovka-apache-airflow-2-freeipa-apache-hadoop-scenarii-udaleniya"><span class="td-sidebar-nav-active-item">Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsbigdataapacheairflowustanovka-apache-airflow-i-nastroika-ego-dlya-raboty-s-apache-hadoop-li">
  <a href="/manuals/bigdata/apacheairflow/ustanovka-apache-airflow-i-nastroika-ego-dlya-raboty-s-apache-hadoop/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsbigdataapacheairflowustanovka-apache-airflow-i-nastroika-ego-dlya-raboty-s-apache-hadoop"><span class="">Установка Apache Airflow и настройка его для работы с Apache Hadoop (устарело)</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsborgbackup-li">
  <a href="/manuals/borgbackup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsborgbackup"><span class="">BorgBackup</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupustanovka-borgbackup-v-centos-i-ubuntu-li">
  <a href="/manuals/borgbackup/ustanovka-borgbackup-v-centos-i-ubuntu/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupustanovka-borgbackup-v-centos-i-ubuntu"><span class="">10. Установка BorgBackup в CentOS и Ubuntu</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupustanovka-borgbackup-v-altlinux-9-10-li">
  <a href="/manuals/borgbackup/ustanovka-borgbackup-v-altlinux-9-10/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupustanovka-borgbackup-v-altlinux-9-10"><span class="">12. Установка BorgBackup в AltLinux 9/10</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupustanovka-borgbackup-v-redos-72-li">
  <a href="/manuals/borgbackup/ustanovka-borgbackup-v-redos-7.2/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupustanovka-borgbackup-v-redos-72"><span class="">13. Установка BorgBackup в RedOS 7.2</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupnastroyka-borg-servera-li">
  <a href="/manuals/borgbackup/nastroyka-borg-servera/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupnastroyka-borg-servera"><span class="">14. Настройка BorgBackup-сервера</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupnastroyka-pervogo-borg-repo-li">
  <a href="/manuals/borgbackup/nastroyka-pervogo-borg-repo/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupnastroyka-pervogo-borg-repo"><span class="">16. Настройка первого borg-репо</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupsozdaniye-shlyuza-v-udalonnoy-is-dlya-dostupa-khostov-k-bekap-serveru-li">
  <a href="/manuals/borgbackup/sozdaniye-shlyuza-v-udalonnoy-is-dlya-dostupa-khostov-k-bekap-serveru/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupsozdaniye-shlyuza-v-udalonnoy-is-dlya-dostupa-khostov-k-bekap-serveru"><span class="">18. Создание шлюза в удалённой ИС для доступа хостов к бэкап-серверу</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupsozdaniye-bekapa-vsey-sistemy-s-pomoshchyu-borgbackup-li">
  <a href="/manuals/borgbackup/sozdaniye-bekapa-vsey-sistemy-s-pomoshchyu-borgbackup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupsozdaniye-bekapa-vsey-sistemy-s-pomoshchyu-borgbackup"><span class="">20. Создание бэкапа всей системы с помощью LVM и BorgBackup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupvosstanovleniye-vsey-sistemy-iz-bekapa-s-pomoshchyu-borgbackup-li">
  <a href="/manuals/borgbackup/vosstanovleniye-vsey-sistemy-iz-bekapa-s-pomoshchyu-borgbackup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupvosstanovleniye-vsey-sistemy-iz-bekapa-s-pomoshchyu-borgbackup"><span class="">30. Восстановление всей системы из бэкапа с помощью LVM и BorgBackup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupnakatyvanie-na-host-chuzhogo-snimka-s-pomoshchyu-borgbackup-li">
  <a href="/manuals/borgbackup/nakatyvanie-na-host-chuzhogo-snimka-s-pomoshchyu-borgbackup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupnakatyvanie-na-host-chuzhogo-snimka-s-pomoshchyu-borgbackup"><span class="">31. Накатывание на хост чужого снимка с помощью LVM и BorgBackup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsborgbackupustanovka-novogo-yadra-v-altlinux-10-dlya-proverki-vosstanovleniya-mashiny-s-pomoshchyu-borgbackup-li">
  <a href="/manuals/borgbackup/ustanovka-novogo-yadra-v-altlinux-10-dlya-proverki-vosstanovleniya-mashiny-s-pomoshchyu-borgbackup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsborgbackupustanovka-novogo-yadra-v-altlinux-10-dlya-proverki-vosstanovleniya-mashiny-s-pomoshchyu-borgbackup"><span class="">40. Установка нового ядра в AltLinux 10 для проверки правильности восстановления машины с помощью BorgBackup</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsfreeipa-li">
  <a href="/manuals/freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsfreeipa"><span class="">FreeIPA</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsfreeipacheckipaconsistency-utilita-dlya-opredeleniya-rassinhronizacii-replik-freeipa-li">
  <a href="/manuals/freeipa/checkipaconsistency-utilita-dlya-opredeleniya-rassinhronizacii-replik-freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsfreeipacheckipaconsistency-utilita-dlya-opredeleniya-rassinhronizacii-replik-freeipa"><span class="">Checkipaconsistency. Утилита для определения рассинхронизации реплик FreeIPA</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5-li">
  <a href="/manuals/freeipa/sozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5"><span class="">Создание и конфигурирование нового домена IPA 4.9.6 на AlmaLinux 8.5</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5udaleniye-repliki-li">
  <a href="/manuals/freeipa/sozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5/udaleniye-repliki/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5udaleniye-repliki"><span class="">00. Удаление реплики</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5podgotovka-khostov-k-ustanovke-replikatsii-freeipa-li">
  <a href="/manuals/freeipa/sozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5/podgotovka-khostov-k-ustanovke-replikatsii-freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5podgotovka-khostov-k-ustanovke-replikatsii-freeipa"><span class="">01. Подготовка хостов к установке реплик FreeIPA</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5ustanovka-pervogo-freeipa-servera-li">
  <a href="/manuals/freeipa/sozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5/ustanovka-pervogo-freeipa-servera/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5ustanovka-pervogo-freeipa-servera"><span class="">02. Установка первого FreeIPA-сервера</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5dobavleniye-replik-k-pervomu-serveru-freeipa-li">
  <a href="/manuals/freeipa/sozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5/dobavleniye-replik-k-pervomu-serveru-freeipa/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsfreeipasozdaniye-i-konfigurirovaniye-novogo-domena-ipa-4-9-6-na-almalinux-8-5dobavleniye-replik-k-pervomu-serveru-freeipa"><span class="">03. Добавление реплик к первому серверу FreeIPA</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsvpn-li">
  <a href="/manuals/vpn/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsvpn"><span class="">VPN</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnobfuskaciya-ssh-trafika-s-pomoschyu-stunnel-li">
  <a href="/manuals/vpn/obfuskaciya-ssh-trafika-s-pomoschyu-stunnel/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnobfuskaciya-ssh-trafika-s-pomoschyu-stunnel"><span class="">Обфускация ssh-трафика с помощью stunnel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnrazvyortyvanie-seti-openvpn-li">
  <a href="/manuals/vpn/razvyortyvanie-seti-openvpn/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnrazvyortyvanie-seti-openvpn"><span class="">Развёртывание сети OpenVPN</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnopenvpn-eto-prosto-li">
  <a href="/manuals/vpn/openvpn-eto-prosto/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnopenvpn-eto-prosto"><span class="">OpenVPN — это просто</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnperevod-easy-rsa-3-quickstart-readme-li">
  <a href="/manuals/vpn/perevod-easy-rsa-3-quickstart-readme/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnperevod-easy-rsa-3-quickstart-readme"><span class="">Перевод Easy-RSA 3 Quickstart README</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnprostoi-centr-sertifikacii-dlya-strongswan-ipsec-li">
  <a href="/manuals/vpn/prostoi-centr-sertifikacii-dlya-strongswan-ipsec/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnprostoi-centr-sertifikacii-dlya-strongswan-ipsec"><span class="">Простой Центр Сертификации для strongSwan IPsec</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsvpnnastraivaem-openvpn-server-na-podklyucheniya-klientov-li">
  <a href="/manuals/vpn/nastraivaem-openvpn-server-na-podklyucheniya-klientov/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsvpnnastraivaem-openvpn-server-na-podklyucheniya-klientov"><span class="">Настраиваем OpenVPN сервер на подключение клиентов</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-manualsproxmox-li">
  <a href="/manuals/proxmox/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-manualsproxmox"><span class="">Proxmox</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-manualsproxmoxproxmox-freeipa-ldap-authentication-setup-li">
  <a href="/manuals/proxmox/proxmox-freeipa-ldap-authentication-setup/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-manualsproxmoxproxmox-freeipa-ldap-authentication-setup"><span class=""></span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">

</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#использованные-материалы">Использованные материалы</a></li>
    <li><a href="#заметки">Заметки</a></li>
    <li><a href="#создание-необходимых-групп-во-freeipa-для-аутентификации-в-airflow">Создание необходимых групп во FreeIPA для аутентификации в Airflow</a></li>
    <li><a href="#установка-по">Установка ПО</a>
      <ul>
        <li><a href="#установка-postgresql">Установка PostgreSQL</a></li>
        <li><a href="#установка-дополнительных-пакетов">Установка дополнительных пакетов</a></li>
      </ul>
    </li>
    <li><a href="#создание-системного-локального-пользователя-airflow">Создание системного локального пользователя airflow</a></li>
    <li><a href="#подготовка-к-запуску-airflow">Подготовка к запуску Airflow</a>
      <ul>
        <li><a href="#создание-каталогов-и-конфигурационных-файлов-для-работы-airflow">Создание каталогов и конфигурационных файлов для работы Airflow</a></li>
        <li><a href="#создание-systemd-юнитов">Создание systemd-юнитов</a></li>
        <li><a href="#настройка-логгирования">Настройка логгирования</a></li>
        <li><a href="#создание-базы-данных-airflow-в-postgresql">Создание базы данных airflow в PostgreSQL</a></li>
      </ul>
    </li>
    <li><a href="#создание-сертификата-для-работы-https">Создание сертификата для работы HTTPS</a></li>
    <li><a href="#установка-airflow-пакетов">Установка Airflow-пакетов</a>
      <ul>
        <li><a href="#как-правильно-удалить-все-установленные-пакеты">Как правильно удалить все установленные пакеты</a></li>
      </ul>
    </li>
    <li><a href="#установка">Установка</a></li>
    <li><a href="#настройка-airflow">Настройка Airflow</a>
      <ul>
        <li><a href="#создание-типового-файла-airflowcfg">Создание типового файла <code>airflow.cfg</code></a></li>
        <li><a href="#переключение-airflow-на-использование-postgresql">Переключение Airflow на использование PostgreSQL</a></li>
        <li><a href="#настройка-https-для-web-ui">Настройка HTTPS для Web UI</a></li>
        <li><a href="#настройка-ldap-аутентификации">Настройка LDAP-аутентификации</a></li>
        <li><a href="#попытка-настройки-kerberos">Попытка настройки Kerberos</a></li>
      </ul>
    </li>
    <li><a href="#завершение">Завершение</a></li>
    <li><a href="#почти-полное-удаление-если-потребуется">Почти полное удаление, если потребуется</a></li>
  </ul>
</nav></div>



            <div class="taxonomy taxonomy-terms-cloud taxo-categories">
      <h5 class="taxonomy-title">Categories</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://debuntu.ru/categories/development/" data-taxonomy-term="development"><span class="taxonomy-label">Development</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  <div class="taxonomy taxonomy-terms-cloud taxo-tags">
      <h5 class="taxonomy-title">Tags</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/acl/" data-taxonomy-term="acl"><span class="taxonomy-label">ACL</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/almalinux-8.5/" data-taxonomy-term="almalinux-8.5"><span class="taxonomy-label">AlmaLinux 8.5</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/alpine-linux/" data-taxonomy-term="alpine-linux"><span class="taxonomy-label">Alpine Linux</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/altlinux/" data-taxonomy-term="altlinux"><span class="taxonomy-label">AltLinux</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/altlinux-10/" data-taxonomy-term="altlinux-10"><span class="taxonomy-label">AltLinux 10</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/altlinux-9/" data-taxonomy-term="altlinux-9"><span class="taxonomy-label">AltLinux 9</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ansible/" data-taxonomy-term="ansible"><span class="taxonomy-label">Ansible</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ansible-ad-hoc/" data-taxonomy-term="ansible-ad-hoc"><span class="taxonomy-label">Ansible Ad-Hoc</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-airflow/" data-taxonomy-term="apache-airflow"><span class="taxonomy-label">Apache Airflow</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-atlas/" data-taxonomy-term="apache-atlas"><span class="taxonomy-label">Apache Atlas</span><span class="taxonomy-count">17</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-hadoop/" data-taxonomy-term="apache-hadoop"><span class="taxonomy-label">Apache Hadoop</span><span class="taxonomy-count">30</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-hbase/" data-taxonomy-term="apache-hbase"><span class="taxonomy-label">Apache HBase</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-hive/" data-taxonomy-term="apache-hive"><span class="taxonomy-label">Apache Hive</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-kafka/" data-taxonomy-term="apache-kafka"><span class="taxonomy-label">Apache Kafka</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-spark/" data-taxonomy-term="apache-spark"><span class="taxonomy-label">Apache Spark</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-sqoop/" data-taxonomy-term="apache-sqoop"><span class="taxonomy-label">Apache Sqoop</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-tomcat/" data-taxonomy-term="apache-tomcat"><span class="taxonomy-label">Apache Tomcat</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-zookeeper/" data-taxonomy-term="apache-zookeeper"><span class="taxonomy-label">Apache Zookeeper</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apc/" data-taxonomy-term="apc"><span class="taxonomy-label">APC</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apparmor/" data-taxonomy-term="apparmor"><span class="taxonomy-label">AppArmor</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/approx/" data-taxonomy-term="approx"><span class="taxonomy-label">Approx</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apt/" data-taxonomy-term="apt"><span class="taxonomy-label">APT</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apt-cache/" data-taxonomy-term="apt-cache"><span class="taxonomy-label">Apt-Cache</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apt-get/" data-taxonomy-term="apt-get"><span class="taxonomy-label">Apt-Get</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/aptitude/" data-taxonomy-term="aptitude"><span class="taxonomy-label">Aptitude</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/arenadata-hadoop/" data-taxonomy-term="arenadata-hadoop"><span class="taxonomy-label">ArenaData Hadoop</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/automation/" data-taxonomy-term="automation"><span class="taxonomy-label">Automation</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/backup-software/" data-taxonomy-term="backup-software"><span class="taxonomy-label">Backup SoftWare</span><span class="taxonomy-count">10</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/bash/" data-taxonomy-term="bash"><span class="taxonomy-label">Bash</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/beeline/" data-taxonomy-term="beeline"><span class="taxonomy-label">Beeline</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/bigdata/" data-taxonomy-term="bigdata"><span class="taxonomy-label">BigData</span><span class="taxonomy-count">50</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/borgbackup/" data-taxonomy-term="borgbackup"><span class="taxonomy-label">BorgBackup</span><span class="taxonomy-count">10</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/btrfs/" data-taxonomy-term="btrfs"><span class="taxonomy-label">Btrfs</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/centos/" data-taxonomy-term="centos"><span class="taxonomy-label">CentOS</span><span class="taxonomy-count">30</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/centos-7/" data-taxonomy-term="centos-7"><span class="taxonomy-label">CentOS 7</span><span class="taxonomy-count">27</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/centos7/" data-taxonomy-term="centos7"><span class="taxonomy-label">CentOS7</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/chroot/" data-taxonomy-term="chroot"><span class="taxonomy-label">Chroot</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ci/cd/" data-taxonomy-term="ci/cd"><span class="taxonomy-label">CI/CD</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cloudera-cdh-6.3.2/" data-taxonomy-term="cloudera-cdh-6.3.2"><span class="taxonomy-label">Cloudera CDH 6.3.2</span><span class="taxonomy-count">36</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cloudera-hadoop/" data-taxonomy-term="cloudera-hadoop"><span class="taxonomy-label">Cloudera Hadoop</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cloudera-inspect-network-performance/" data-taxonomy-term="cloudera-inspect-network-performance"><span class="taxonomy-label">Cloudera Inspect Network Performance</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cmak/" data-taxonomy-term="cmak"><span class="taxonomy-label">CMAK</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cms/" data-taxonomy-term="cms"><span class="taxonomy-label">CMS</span><span class="taxonomy-count">7</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cockpit/" data-taxonomy-term="cockpit"><span class="taxonomy-label">Cockpit</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/colorized-stdout/" data-taxonomy-term="colorized-stdout"><span class="taxonomy-label">Colorized Stdout</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/composer/" data-taxonomy-term="composer"><span class="taxonomy-label">Composer</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/console/" data-taxonomy-term="console"><span class="taxonomy-label">Console</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/cryptsetup/" data-taxonomy-term="cryptsetup"><span class="taxonomy-label">Cryptsetup</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/curl/" data-taxonomy-term="curl"><span class="taxonomy-label">Curl</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/db/" data-taxonomy-term="db"><span class="taxonomy-label">DB</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/dd-wrt/" data-taxonomy-term="dd-wrt"><span class="taxonomy-label">DD-WRT</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/debian-lenny/" data-taxonomy-term="debian-lenny"><span class="taxonomy-label">Debian Lenny</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/devops/" data-taxonomy-term="devops"><span class="taxonomy-label">DevOps</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/dm-setup/" data-taxonomy-term="dm-setup"><span class="taxonomy-label">Dm-Setup</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/dns/" data-taxonomy-term="dns"><span class="taxonomy-label">DNS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/docker/" data-taxonomy-term="docker"><span class="taxonomy-label">Docker</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/drupal/" data-taxonomy-term="drupal"><span class="taxonomy-label">Drupal</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/easy-rsa/" data-taxonomy-term="easy-rsa"><span class="taxonomy-label">Easy-RSA</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/eclipse/" data-taxonomy-term="eclipse"><span class="taxonomy-label">Eclipse</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/egroupware/" data-taxonomy-term="egroupware"><span class="taxonomy-label">EGroupWare</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/encfs/" data-taxonomy-term="encfs"><span class="taxonomy-label">EncFS</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/filesystem/" data-taxonomy-term="filesystem"><span class="taxonomy-label">FileSystem</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/freebsd/" data-taxonomy-term="freebsd"><span class="taxonomy-label">FreeBSD</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/freeipa/" data-taxonomy-term="freeipa"><span class="taxonomy-label">FreeIPA</span><span class="taxonomy-count">19</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/freeipa-4.9.6/" data-taxonomy-term="freeipa-4.9.6"><span class="taxonomy-label">FreeIPA 4.9.6</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/gnu-screen/" data-taxonomy-term="gnu-screen"><span class="taxonomy-label">GNU Screen</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/groupware/" data-taxonomy-term="groupware"><span class="taxonomy-label">Groupware</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/hbase/" data-taxonomy-term="hbase"><span class="taxonomy-label">HBase</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/hdfs/" data-taxonomy-term="hdfs"><span class="taxonomy-label">HDFS</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/history/" data-taxonomy-term="history"><span class="taxonomy-label">History</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/hive/" data-taxonomy-term="hive"><span class="taxonomy-label">Hive</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/hue/" data-taxonomy-term="hue"><span class="taxonomy-label">Hue</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ide/" data-taxonomy-term="ide"><span class="taxonomy-label">IDE</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/infosec/" data-taxonomy-term="infosec"><span class="taxonomy-label">InfoSec</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ipsec/" data-taxonomy-term="ipsec"><span class="taxonomy-label">IPsec</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/jenkins/" data-taxonomy-term="jenkins"><span class="taxonomy-label">Jenkins</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/jupiterhub/" data-taxonomy-term="jupiterhub"><span class="taxonomy-label">JupiterHub</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/kafdrop/" data-taxonomy-term="kafdrop"><span class="taxonomy-label">Kafdrop</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/kafka/" data-taxonomy-term="kafka"><span class="taxonomy-label">Kafka</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/kafka-mirror-maker/" data-taxonomy-term="kafka-mirror-maker"><span class="taxonomy-label">Kafka-Mirror-Maker</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/kerberos/" data-taxonomy-term="kerberos"><span class="taxonomy-label">Kerberos</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/keytab/" data-taxonomy-term="keytab"><span class="taxonomy-label">Keytab</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/kvm/" data-taxonomy-term="kvm"><span class="taxonomy-label">KVM</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/l2tp/" data-taxonomy-term="l2tp"><span class="taxonomy-label">L2TP</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ldap/" data-taxonomy-term="ldap"><span class="taxonomy-label">LDAP</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/less/" data-taxonomy-term="less"><span class="taxonomy-label">Less</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/libreoffice/" data-taxonomy-term="libreoffice"><span class="taxonomy-label">LibreOffice</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/linux-kernel/" data-taxonomy-term="linux-kernel"><span class="taxonomy-label">Linux Kernel</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/linux-process/" data-taxonomy-term="linux-process"><span class="taxonomy-label">Linux Process</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/logitech/" data-taxonomy-term="logitech"><span class="taxonomy-label">Logitech</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/luks/" data-taxonomy-term="luks"><span class="taxonomy-label">LUKS</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/lvm/" data-taxonomy-term="lvm"><span class="taxonomy-label">LVM</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/lvm2/" data-taxonomy-term="lvm2"><span class="taxonomy-label">LVM2</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/lvresize/" data-taxonomy-term="lvresize"><span class="taxonomy-label">Lvresize</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/lxde/" data-taxonomy-term="lxde"><span class="taxonomy-label">LXDE</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/make/" data-taxonomy-term="make"><span class="taxonomy-label">Make</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/meshnet/" data-taxonomy-term="meshnet"><span class="taxonomy-label">Meshnet</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/mikrotik/" data-taxonomy-term="mikrotik"><span class="taxonomy-label">Mikrotik</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/modx/" data-taxonomy-term="modx"><span class="taxonomy-label">MODx</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/mokey/" data-taxonomy-term="mokey"><span class="taxonomy-label">Mokey</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/monitoring/" data-taxonomy-term="monitoring"><span class="taxonomy-label">Monitoring</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/monitorix/" data-taxonomy-term="monitorix"><span class="taxonomy-label">Monitorix</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/multic/" data-taxonomy-term="multic"><span class="taxonomy-label">Multic</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nat/" data-taxonomy-term="nat"><span class="taxonomy-label">NAT</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/networking/" data-taxonomy-term="networking"><span class="taxonomy-label">Networking</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nextcloud/" data-taxonomy-term="nextcloud"><span class="taxonomy-label">NextCloud</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nexus/" data-taxonomy-term="nexus"><span class="taxonomy-label">Nexus</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nexus-repository-manager/" data-taxonomy-term="nexus-repository-manager"><span class="taxonomy-label">Nexus Repository Manager</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nginx/" data-taxonomy-term="nginx"><span class="taxonomy-label">Nginx</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nokia-e52/" data-taxonomy-term="nokia-e52"><span class="taxonomy-label">Nokia E52</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nut/" data-taxonomy-term="nut"><span class="taxonomy-label">NUT</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/nxrm/" data-taxonomy-term="nxrm"><span class="taxonomy-label">NXRM</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/oauth2/" data-taxonomy-term="oauth2"><span class="taxonomy-label">OAuth2</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/obfuscation/" data-taxonomy-term="obfuscation"><span class="taxonomy-label">Obfuscation</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/openssh/" data-taxonomy-term="openssh"><span class="taxonomy-label">OpenSSH</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/openvpn/" data-taxonomy-term="openvpn"><span class="taxonomy-label">OpenVPN</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/openwrt/" data-taxonomy-term="openwrt"><span class="taxonomy-label">OpenWRT</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/path-mtu-discovery/" data-taxonomy-term="path-mtu-discovery"><span class="taxonomy-label">Path MTU Discovery</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/pip/" data-taxonomy-term="pip"><span class="taxonomy-label">Pip</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/pkgng/" data-taxonomy-term="pkgng"><span class="taxonomy-label">Pkgng</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/pki/" data-taxonomy-term="pki"><span class="taxonomy-label">PKI</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/plone/" data-taxonomy-term="plone"><span class="taxonomy-label">Plone</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/portsnap/" data-taxonomy-term="portsnap"><span class="taxonomy-label">Portsnap</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/postgresql/" data-taxonomy-term="postgresql"><span class="taxonomy-label">PostgreSQL</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/python/" data-taxonomy-term="python"><span class="taxonomy-label">Python</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/qemu/kvm/" data-taxonomy-term="qemu/kvm"><span class="taxonomy-label">QEMU/KVM</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/qemu/kvm/" data-taxonomy-term="qemu/kvm"><span class="taxonomy-label">QEMU/KVM</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/raid/" data-taxonomy-term="raid"><span class="taxonomy-label">RAID</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/redos/" data-taxonomy-term="redos"><span class="taxonomy-label">RedOS</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/redos-7.2/" data-taxonomy-term="redos-7.2"><span class="taxonomy-label">RedOS 7.2</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/resolv.conf/" data-taxonomy-term="resolv.conf"><span class="taxonomy-label">Resolv.conf</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/root/" data-taxonomy-term="root"><span class="taxonomy-label">Root</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/rsync/" data-taxonomy-term="rsync"><span class="taxonomy-label">Rsync</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/sentry/" data-taxonomy-term="sentry"><span class="taxonomy-label">Sentry</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/solr/" data-taxonomy-term="solr"><span class="taxonomy-label">Solr</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/spark/" data-taxonomy-term="spark"><span class="taxonomy-label">Spark</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/squid/" data-taxonomy-term="squid"><span class="taxonomy-label">Squid</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/squidguard/" data-taxonomy-term="squidguard"><span class="taxonomy-label">SquidGuard</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ssh/" data-taxonomy-term="ssh"><span class="taxonomy-label">Ssh</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/strongswan/" data-taxonomy-term="strongswan"><span class="taxonomy-label">StrongSwan</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/stunnel/" data-taxonomy-term="stunnel"><span class="taxonomy-label">Stunnel</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/sudo/" data-taxonomy-term="sudo"><span class="taxonomy-label">Sudo</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/swap/" data-taxonomy-term="swap"><span class="taxonomy-label">Swap</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/syslinux/" data-taxonomy-term="syslinux"><span class="taxonomy-label">Syslinux</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/terminal/" data-taxonomy-term="terminal"><span class="taxonomy-label">Terminal</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/traditional-unix-permission/" data-taxonomy-term="traditional-unix-permission"><span class="taxonomy-label">Traditional Unix Permission</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/translation/" data-taxonomy-term="translation"><span class="taxonomy-label">Translation</span><span class="taxonomy-count">10</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/truecrypt/" data-taxonomy-term="truecrypt"><span class="taxonomy-label">TrueCrypt</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/ubuntu/" data-taxonomy-term="ubuntu"><span class="taxonomy-label">Ubuntu</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/unix/" data-taxonomy-term="unix"><span class="taxonomy-label">Unix</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/venv/" data-taxonomy-term="venv"><span class="taxonomy-label">Venv</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/vertica/" data-taxonomy-term="vertica"><span class="taxonomy-label">Vertica</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/vfs/" data-taxonomy-term="vfs"><span class="taxonomy-label">VFS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/virtualization/" data-taxonomy-term="virtualization"><span class="taxonomy-label">Virtualization</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/visual-studio-code/" data-taxonomy-term="visual-studio-code"><span class="taxonomy-label">Visual Studio Code</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/vmware-server/" data-taxonomy-term="vmware-server"><span class="taxonomy-label">VMWare Server</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/void-linux/" data-taxonomy-term="void-linux"><span class="taxonomy-label">Void Linux</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/voip/" data-taxonomy-term="voip"><span class="taxonomy-label">VoIP</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/vpn/" data-taxonomy-term="vpn"><span class="taxonomy-label">VPN</span><span class="taxonomy-count">5</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/windows-xp/" data-taxonomy-term="windows-xp"><span class="taxonomy-label">Windows XP</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/xfs/" data-taxonomy-term="xfs"><span class="taxonomy-label">XFS</span><span class="taxonomy-count">2</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/yarn/" data-taxonomy-term="yarn"><span class="taxonomy-label">YARN</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://debuntu.ru/tags/zookeper/" data-taxonomy-term="zookeper"><span class="taxonomy-label">Zookeper</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/manuals/">Инструкции</a></li>
  <li class="breadcrumb-item">
    <a href="/manuals/bigdata/">BigData</a></li>
  <li class="breadcrumb-item">
    <a href="/manuals/bigdata/apacheairflow/">Apache Airflow</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Установка Apache Airflow 2 &#43; FreeIPA &#43; Apache Hadoop &#43; сценарий удаления</h1>
	<div class="lead">Описание установки на Cloudera Hadoop узел экземпляра Airflow второй версии с назначением ролей из FreeIPA.</div>
	<header class="article-meta">
		<div class="taxonomy taxonomy-terms-article taxo-tags">
  <h5 class="taxonomy-title">Tags:</h5>
  <ul class="taxonomy-terms">
    <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-airflow/" data-taxonomy-term="apache-airflow"><span class="taxonomy-label">Apache Airflow</span></a></li>
    <li><a class="taxonomy-term" href="https://debuntu.ru/tags/freeipa/" data-taxonomy-term="freeipa"><span class="taxonomy-label">FreeIPA</span></a></li>
    <li><a class="taxonomy-term" href="https://debuntu.ru/tags/apache-hadoop/" data-taxonomy-term="apache-hadoop"><span class="taxonomy-label">Apache Hadoop</span></a></li>
    <li><a class="taxonomy-term" href="https://debuntu.ru/tags/centos/" data-taxonomy-term="centos"><span class="taxonomy-label">CentOS</span></a></li>
    <li><a class="taxonomy-term" href="https://debuntu.ru/tags/centos-7/" data-taxonomy-term="centos-7"><span class="taxonomy-label">CentOS 7</span></a></li>
    </ul>
</div>

</header>
	<h2 id="использованные-материалы">Использованные материалы</h2>
<ul>
<li><a href="https://airflow.apache.org/docs/apache-airflow/stable/">Apache Airflow Documentation</a></li>
<li><a href="https://airflow.apache.org/docs/apache-airflow/stable/start/index.html">Quick Start</a></li>
<li>Предыдущий опыт настройки Airflow прошлых версий.</li>
</ul>
<h2 id="заметки">Заметки</h2>
<ul>
<li>В шагах инструкции пока отсутствует. Важно опроовать.
После скачивания свежего файла с зависимостями дл apache-airflow, необходимо изменить в этом файле строку &lsquo;Flask-AppBuilder==3.1.1&rsquo; на &lsquo;Flask-AppBuilder==3.2.0&rsquo;, чтобы заработал мэппинг между пользовательскими группами в IPA и ролями в Airflow.
Для уже установленных экземпляров Airflow, можно изменить соответствующую строку в файле &lsquo;/usr/local/lib/python3.6/site-packages/apache_airflow-2.0.1.dist-info/METADATA&rsquo;.</li>
<li>Если пользовательские DAG&rsquo;и запускаются через &lsquo;run_as_user&rsquo;, то необходимо обеспечить чтение файла <code>/etc/airflow/airflow.cfg</code> этими пользователями, иначе DAG&rsquo;и не будут выполнены с ошибкой &lsquo;airflow.exceptions.AirflowConfigException: error: cannot use sqlite version &lt; 3.15.0&rsquo;</li>
<li>Если в DAG&rsquo;е указать &lsquo;run_as_user&rsquo;: &rsquo;eugene&rsquo;, то Airflow запускает процесс от имени пользователя командой <code>sudo -E -H -u eugene</code>, в результате которой процесс пользователя наследует переменные родительского процесса, а переменная HOME меняется на пользовательскую директорию в /home.</li>
<li>Надо дать права на подпапки в рабочей папке airflow для группы пользователей prod_airflow_airf1, так как запускаемый дочерний run_as процесс от имени пользователя, должен иметь право на запись в рабочую папку Airflow.</li>
<li>Установку python-пакетов производить под учётной записью пользователя. Лишь пакеты airflow должны быть установлены под системной учётной записью.</li>
<li>Разграничение DAG&rsquo;ов между пользователями задаётся внутри DAG&rsquo;а строкой: &lsquo;owner&rsquo;: &rsquo;eugene&rsquo;. Это не работает во второй версии Airflow?</li>
<li>В /etc/pip.conf необходимо добавить python-репо в Nexus&rsquo;е с пользовательскими библиотеками, чтобы пользователь мог вызвать pip install прямо из своего кода, без дополнительных операций?</li>
<li>Для сборки некоторых python-пакетов (найти где я это делал), pydoop, и ещё один пакет, &hellip;., требуется установить компилятор gcc-c++, полный пакет явы с инструментами разработчика.</li>
</ul>
<h2 id="создание-необходимых-групп-во-freeipa-для-аутентификации-в-airflow">Создание необходимых групп во FreeIPA для аутентификации в Airflow</h2>
<p>Во второй версии Airflow изменился способ аутентификации и авторизации пользователей. Теперь из коробки активирован режим RBAC, то есть аутентификация и авторизация выполняется силами Flask App Builder (FAB).</p>
<p>Для аутентификации создаём одну POSIX-группу &lsquo;prod_airflow_airf1&rsquo;, участники которой, будут иметь доступ к Web UI интерфейсу Airflow, а также эта группа будет особым образом назначена на каталог /data/airflow для того, чтобы участники имели доступ к своим DAGам и логам в подпапках этого каталога, но не имели доступа к конфигурационным файлам Airflow.</p>
<p>Управление авторизацией будет происходить через роли в Airflow отображённые во вложенные группы IPA. По умолчанию, новому пользователю назначается роль &lsquo;Viewer&rsquo; в дополнение к роли, полученной из соответствующей группы IPA.</p>
<h2 id="установка-по">Установка ПО</h2>
<p>Предполагается, что на машине уже установлены пакеты &lsquo;python3&rsquo; и &lsquo;python3-pip&rsquo;.</p>
<h3 id="установка-postgresql">Установка PostgreSQL</h3>
<p>Для работы Airflow в prod-режиме рекомендуется использовать PostgreSQL, вместо используемого по умолчанию SQLite. Ничего сложного в этом этапе нет.</p>
<p>Добавляем в /etc/yum.repos.d/ подготовленный файл из статьи по Nexus&rsquo;у pub_postgresql_yum:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>USERNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;nx-pubrepo-reader&#34;</span>
</span></span><span style="display:flex;"><span>PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xxxxxxxxxxx&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF | tee -a /etc/yum.repos.d/pgdg-redhat-all.repo
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#######################################################
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># PGDG Red Hat Enterprise Linux / CentOS repositories #
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#######################################################
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># PGDG Red Hat Enterprise Linux / CentOS stable common repository for all PostgreSQL versions
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[pgdg-common]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">username=$USERNAME
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">password=$PASSWORD
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">name=PostgreSQL common RPMs for RHEL/CentOS \$releasever - \$basearch
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">baseurl=http://nexus.example.org:8081/repository/all_postgresql_yum/common/redhat/rhel-\$releasever-\$basearch
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">enabled=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgcheck=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgkey=http://nexus.example.org:8081/repository/all_postgresql_yum/RPM-GPG-KEY-PGDG-AARCH64
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># PGDG Red Hat Enterprise Linux / CentOS stable repositories:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[pgdg13]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">username=$USERNAME
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">password=$PASSWORD
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">name=PostgreSQL 13 for RHEL/CentOS \$releasever - \$basearch
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">baseurl=http://nexus.example.org:8081/repository/all_postgresql_yum/13/redhat/rhel-\$releasever-\$basearch
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">enabled=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgcheck=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgkey=http://nexus.example.org:8081/repository/all_postgresql_yum/RPM-GPG-KEY-PGDG-AARCH64
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>Устанавливаем актуальную версию PosgreSQL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo yum update
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Install PostgreSQL:</span>
</span></span><span style="display:flex;"><span>sudo yum -y install postgresql13-server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Optionally initialize the database and enable automatic start:</span>
</span></span><span style="display:flex;"><span>sudo /usr/pgsql-13/bin/postgresql-13-setup initdb
</span></span><span style="display:flex;"><span>sudo systemctl enable --now postgresql-13
</span></span></code></pre></div><h3 id="установка-дополнительных-пакетов">Установка дополнительных пакетов</h3>
<p>Устанавливаем пакеты для разработки:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo yum -y groupinstall <span style="color:#e6db74">&#34;Development Tools&#34;</span>
</span></span><span style="display:flex;"><span>sudo yum -y install python3-devel cyrus-sasl cyrus-sasl-devel libffi-devel krb5-devel
</span></span></code></pre></div><p>Для работы LDAP-аутентификации в FAB требуется установка пакета python-ldap, который не соберётся, если не установить:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo yum -y install openldap-devel python-devel
</span></span></code></pre></div><h2 id="создание-системного-локального-пользователя-airflow">Создание системного локального пользователя airflow</h2>
<p>Создаём системного пользователя airflow и разрешаем ему беспарольное sudo для имперсонации, то есть запуска скриптов от имени владельца:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo useradd -r airflow -s /sbin/nologin
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;airflow ALL=(ALL) NOPASSWD: ALL&#34;</span> | sudo tee /etc/sudoers.d/airflow
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">440</span> /etc/sudoers.d/airflow
</span></span></code></pre></div><h2 id="подготовка-к-запуску-airflow">Подготовка к запуску Airflow</h2>
<p>Необходимо ввести машину в Cloudera-кластер, иначе каталог &lsquo;/etc/hadoop&rsquo; и важные переменные будут отсутствовать на машине.</p>
<h3 id="создание-каталогов-и-конфигурационных-файлов-для-работы-airflow">Создание каталогов и конфигурационных файлов для работы Airflow</h3>
<p>Создаём в IPA POSIX-группу для аутентификации в Airflow и, одновременно, для доступа пользователей к каталогам dags,logs,plugins. И сразу создадим вложенные Non-POSIX группы для авторизации в Airflow. Чуть позже настроим их отображение на локальные Airflow-роли. Важно поменять переменные перед использованием этого скрипта:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Если требуется kerberos-тикет, то  не забываем:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># kinit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Номер Jira-задачи</span>
</span></span><span style="display:flex;"><span>JIRA<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;SDK-2198&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Название ИС</span>
</span></span><span style="display:flex;"><span>IS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;prod&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#IS=&#34;dev&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#IS=&#34;devdmz&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Название сервиса:</span>
</span></span><span style="display:flex;"><span>SERVICE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airflow&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Псевдоним экземпляра Airflow</span>
</span></span><span style="display:flex;"><span>ALIAS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Группа администраторов в IPA</span>
</span></span><span style="display:flex;"><span>ADMINSGROUP<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;admins&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Составляем название группы:</span>
</span></span><span style="display:flex;"><span>GROUPNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>IS<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>SERVICE<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa group-add <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span> --desc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Пользователи имеющие право для аутентификации в </span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">. Авторизация настраивается через вложенные группы. Это POSIX-группа, потому что она же назначена на каталоги {dags,logs,plugins} для доступа юзеров к их дагам и логам. </span><span style="color:#e6db74">${</span>JIRA<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>ipa group-add <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_admins --desc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Группа отображается в роль Admin сервиса </span>$SERVICE<span style="color:#e6db74"> на </span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span>JIRA<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span> --nonposix
</span></span><span style="display:flex;"><span>ipa group-add <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_ops --desc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Группа отображается в роль Op сервиса </span>$SERVICE<span style="color:#e6db74"> на </span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span>JIRA<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span> --nonposix
</span></span><span style="display:flex;"><span>ipa group-add <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_users --desc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Группа отображается в роль User сервиса </span>$SERVICE<span style="color:#e6db74"> на </span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span>JIRA<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span> --nonposix
</span></span><span style="display:flex;"><span>ipa group-add <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_viewers --desc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Группа отображается в роль Viewer сервиса </span>$SERVICE<span style="color:#e6db74"> на </span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">. </span><span style="color:#e6db74">${</span>JIRA<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span> --nonposix
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa group-add-member <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span> --groups<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_admins --groups<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_ops --groups<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_users --groups<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_viewers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa group-add-member <span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>_admins --groups<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>ADMINSGROUP<span style="color:#e6db74">}</span>
</span></span></code></pre></div><p>Сейчас же создаём каталог для работы Apache Airflow и назначаем права:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># POSIX-группа предназачена для доступа пользователей к нужным папкам.</span>
</span></span><span style="display:flex;"><span>export POSIXGROUP<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>export DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/data/airflow&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo mkdir -p $DIR/<span style="color:#f92672">{</span>dags,logs,plugins<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>sudo chmod -R <span style="color:#ae81ff">750</span> $DIR
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">2750</span> $DIR/<span style="color:#f92672">{</span>dags,plugins<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>sudo chown -R airflow.airflow $DIR
</span></span><span style="display:flex;"><span>sudo setfacl -m d:g:<span style="color:#e6db74">${</span>POSIXGROUP<span style="color:#e6db74">}</span>:rwx $DIR/<span style="color:#f92672">{</span>dags,logs,plugins<span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>В последней команде мы назначаем default-права на каталог общей POSIX-группе prod_airflow_airf1 из FreeIPA, чтобы все наследуемые пользователи из вложенных групп имели доступ к папкам dags, logs и plugins. Эти права будут наследоваться с режимом 770 для поддиректорий и 660 для файлов.</li>
<li>Заметка: POSIX ACL не работает с MemberOf-группами из FreeIPA, но работает с  POSIX-группами.</li>
</ul>
<p>Создаём файл <code>/etc/sysconfig/airflow</code> с переменными, использующимися airflow при запуске из systemd-юнитов:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/etc/sysconfig/airflow&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;AIRFLOW_HOME=/data/airflow&#34;</span> | sudo tee $FILE
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;AIRFLOW_CONFIG=/etc/airflow/airflow.cfg&#34;</span> | sudo tee -a $FILE
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;HADOOP_CONF_DIR=/etc/hadoop/conf&#34;</span> | sudo tee -a $FILE
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;HIVE_CONF_DIR=/etc/hive/conf&#34;</span> | sudo tee -a $FILE
</span></span></code></pre></div><ul>
<li>Без переменных &lsquo;HADOOP_CONF_DIR&rsquo; и &lsquo;HIVE_CONF_DIR&rsquo;, в Airflow не будет работать SparkSubmitOperator, так как он использует файлы <code>hive_site.xml</code> и <code>yarn-site.xml</code>.</li>
</ul>
<p>Создаём каталог <code>/etc/airflow</code> для хранения <code>airflow.cfg</code>, сертификатов, keytab&rsquo;ов и прочих подобных файлов:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>DIR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/etc/airflow&#34;</span>
</span></span><span style="display:flex;"><span>sudo mkdir $DIR
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">2770</span> $DIR
</span></span><span style="display:flex;"><span>sudo chown airflow.airflow $DIR
</span></span></code></pre></div><h3 id="создание-systemd-юнитов">Создание systemd-юнитов</h3>
<p>Взято из <a href="https://github.com/apache/airflow/tree/master/scripts/systemd">https://github.com/apache/airflow/tree/master/scripts/systemd</a>. При появлении других зависимостей для запуска сервисов Airflow, добавляем их в строки After и Wants. Примеры можно посмотреть в <a href="https://github.com/apache/airflow/tree/master/scripts/systemd">https://github.com/apache/airflow/tree/master/scripts/systemd</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF | sudo tee /etc/systemd/system/airflow-scheduler.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Unit]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Description=Airflow scheduler daemon
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">After=network.target postgresql-13.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Wants=postgresql-13.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Service]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EnvironmentFile=/etc/sysconfig/airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">User=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Group=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Type=simple
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ExecStart=/usr/local/bin/airflow scheduler
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Restart=always
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RestartSec=5s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">SyslogIdentifier=airf-sched
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Install]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">WantedBy=multi-user.target
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF | sudo tee /etc/systemd/system/airflow-webserver.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Unit]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Description=Airflow webserver daemon
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">After=network.target postgresql-13.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Wants=postgresql-13.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Service]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EnvironmentFile=/etc/sysconfig/airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RuntimeDirectory=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RuntimeDirectoryMode=0775
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">User=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Group=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Type=simple
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ExecStart=/usr/local/bin/airflow webserver -p 8080 --pid /run/airflow/airflow-webserver.pid
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Restart=on-failure
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RestartSec=5s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">PrivateTmp=true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">SyslogIdentifier=airf-web
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Install]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">WantedBy=multi-user.target
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><h3 id="настройка-логгирования">Настройка логгирования</h3>
<p>Настраиваем сразу с заделом на включение Kerberos (airf-krb), каковое включение описано ниже и производится по желанию, потому что пока не понятно работоспособен ли Kerberos с Airflow на Python 3:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir /var/log/airflow
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">750</span> /var/log/airflow
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;if $programname == &#34;airf-sched&#34; then /var/log/airflow/airf-sched.log
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&amp; stop&#39;</span> | sudo tee /etc/rsyslog.d/airf-sched.conf
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;if $programname == &#34;airf-web&#34; then /var/log/airflow/airf-web.log
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&amp; stop&#39;</span> | sudo tee /etc/rsyslog.d/airf-web.conf
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;if $programname == &#34;airf-krb&#34; then /var/log/airflow/airf-krb.log
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&amp; stop&#39;</span> | sudo tee /etc/rsyslog.d/airf-krb.conf
</span></span><span style="display:flex;"><span>sudo systemctl restart rsyslog
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;1i /var/log/airflow/airf-sched.log\n/var/log/airflow/airf-web.log\n/var/log/airflow/airf-krb.log&#39;</span> /etc/logrotate.d/syslog
</span></span></code></pre></div><h3 id="создание-базы-данных-airflow-в-postgresql">Создание базы данных airflow в PostgreSQL</h3>
<p>Далее приведены команды в psql для создания базы данных:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>DBNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf_metadata&#34;</span>
</span></span><span style="display:flex;"><span>DBUSER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf_user&#34;</span>
</span></span><span style="display:flex;"><span>AIRFPASS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cat /dev/urandom | tr -dc A-Za-z0-9 | head -c15<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo -u postgres psql -c <span style="color:#e6db74">&#34;CREATE DATABASE </span><span style="color:#e6db74">${</span>DBNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">;&#34;</span>
</span></span><span style="display:flex;"><span>sudo -u postgres psql -c <span style="color:#e6db74">&#34;CREATE USER </span><span style="color:#e6db74">${</span>DBUSER<span style="color:#e6db74">}</span><span style="color:#e6db74"> WITH password &#39;</span><span style="color:#e6db74">${</span>AIRFPASS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;;&#34;</span>
</span></span><span style="display:flex;"><span>sudo -u postgres psql -c <span style="color:#e6db74">&#34;GRANT ALL PRIVILEGES ON DATABASE </span><span style="color:#e6db74">${</span>DBNAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> TO </span><span style="color:#e6db74">${</span>DBUSER<span style="color:#e6db74">}</span><span style="color:#e6db74">;&#34;</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DBUSER<span style="color:#e6db74">}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">${</span>AIRFPASS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> | sudo tee /etc/airflow/psql-pass.txt
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DBNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> | sudo tee /etc/airflow/psql-db.txt
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">400</span> /etc/airflow/psql-pass.txt /etc/airflow/psql-db.txt
</span></span></code></pre></div><h2 id="создание-сертификата-для-работы-https">Создание сертификата для работы HTTPS</h2>
<p>Подготавливаем ключ и сертификат для Web UI Airflow. Чтобы было удобней, выбираем короткое имя для URL: &lsquo;prod-airf1.example.org&rsquo;.</p>
<p>Если требуется, то сначала получаем kerberos-билет:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kinit
</span></span></code></pre></div><p>После чего получаем сертификат, который будет действителен для двух dns-имени, prod-airf01p.example.org и airf1.example.org. Важно поменять переменные перед использованием этого скрипта:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Меняем на требуемое короткий псевдоним:</span>
</span></span><span style="display:flex;"><span>export ALIAS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;prod-airf1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#export ALIAS=&#34;dev-airf1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#export ALIAS=&#34;devdmz-airf1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>export SHORTHOSTNAME<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>hostname -s<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>export DOMAIN<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>hostname -d<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>export ALIASHOSTNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">${</span>DOMAIN<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>export DOMAINCAPS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo <span style="color:#66d9ef">$(</span>hostname -d<span style="color:#66d9ef">)</span>|tr <span style="color:#f92672">[</span>:lower:<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>:upper:<span style="color:#f92672">]</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Добавляем CNAME-запись для текущей машины в DNS-зону...</span>
</span></span><span style="display:flex;"><span>ipa dnsrecord-add $DOMAIN $ALIAS --cname-rec<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Добавляем сервис-принципал для текущей машины...</span>
</span></span><span style="display:flex;"><span>ipa service-add HTTP/<span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span>@<span style="color:#e6db74">${</span>DOMAINCAPS<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Добавляем alias для созданного ранее сервис-принципала...</span>
</span></span><span style="display:flex;"><span>ipa service-add-principal HTTP/<span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span> HTTP/<span style="color:#e6db74">${</span>ALIASHOSTNAME<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># С помощью локального certmonger&#39;а генерируруем приватный ключ и</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># сертификат к нему, чтобы airflow web ui смог работать через https.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Certmonger будет следить за сертификатом и за 28 дней до окончания срока действия,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># автоматически подаст запрос к FreeIPA на новый сертификат.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Заметим, что сертификат во FreeIPA прикреплен к сервис-принципалу, а не к хосту.</span>
</span></span><span style="display:flex;"><span>sudo ipa-getcert request -K HTTP/<span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-f /etc/airflow/<span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span>_<span style="color:#e6db74">${</span>SHORTHOSTNAME<span style="color:#e6db74">}</span>.crt <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-k /etc/airflow/<span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span>_<span style="color:#e6db74">${</span>SHORTHOSTNAME<span style="color:#e6db74">}</span>.key <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-D <span style="color:#e6db74">${</span>ALIASHOSTNAME<span style="color:#e6db74">}</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>-C <span style="color:#e6db74">&#34;/bin/bash -c &#39;/usr/bin/systemctl restart airflow-webserver &amp;&amp; /bin/chmod 640 /etc/airflow/</span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">${</span>SHORTHOSTNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">.{crt,key}&#39;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Выставляем права на файлы ключа и сертификата...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># sudo chmod 640 /etc/airflow/${ALIAS}_${SHORTHOSTNAME}.{crt,key}</span>
</span></span></code></pre></div><p>Если понадобится, то отслеживаемые сертификаты выводим командой:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Выводим список отслеживаемых сертификатов...</span>
</span></span><span style="display:flex;"><span>$ sudo getcert list
</span></span><span style="display:flex;"><span>  Number of certificates and requests being tracked: 1.
</span></span><span style="display:flex;"><span>  Request ID <span style="color:#e6db74">&#39;20210129140146&#39;</span>:
</span></span><span style="display:flex;"><span>        status: MONITORING
</span></span><span style="display:flex;"><span>        stuck: no
</span></span><span style="display:flex;"><span>        key pair storage: type<span style="color:#f92672">=</span>FILE,location<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/etc/airflow/airf1_prod-airf01p.key&#39;</span>
</span></span><span style="display:flex;"><span>        certificate: type<span style="color:#f92672">=</span>FILE,location<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/etc/airflow/airf1_prod-airf01p.crt&#39;</span>
</span></span><span style="display:flex;"><span>        CA: IPA
</span></span><span style="display:flex;"><span>        issuer: CN<span style="color:#f92672">=</span>Certificate Authority,O<span style="color:#f92672">=</span>example.org
</span></span><span style="display:flex;"><span>        subject: CN<span style="color:#f92672">=</span>prod-airf01p.example.org,O<span style="color:#f92672">=</span>example.org
</span></span><span style="display:flex;"><span>        expires: 2023-01-30 14:01:46 UTC
</span></span><span style="display:flex;"><span>        dns: prod-airf1.example.org,prod-airf01p.example.org
</span></span><span style="display:flex;"><span>        principal name: HTTP/prod-airf01p.example.org@example.org
</span></span><span style="display:flex;"><span>        key usage: digitalSignature,nonRepudiation,keyEncipherment,dataEncipherment
</span></span><span style="display:flex;"><span>        eku: id-kp-serverAuth,id-kp-clientAuth
</span></span><span style="display:flex;"><span>        pre-save command:
</span></span><span style="display:flex;"><span>        post-save command:
</span></span><span style="display:flex;"><span>        track: yes
</span></span><span style="display:flex;"><span>        auto-renew: yes
</span></span></code></pre></div><p>Если понадобится снять сертификат с отслеживания, то выполняем &lsquo;getcert list&rsquo;, выбираем сертификат и даём команду снятия с отслеживания:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo ipa-getcert stop-tracking -i <span style="color:#ae81ff">20210129140146</span>
</span></span></code></pre></div><p>Если нужно вновь поставить сертификат на автообновление, то выполняем, например:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo ipa-getcert start-tracking -f /etc/airflow/prod-airf1_prod-airf01p.crt -k /etc/airflow/prod-airf1_prod-airf01p.key
</span></span></code></pre></div><h2 id="установка-airflow-пакетов">Установка Airflow-пакетов</h2>
<h3 id="как-правильно-удалить-все-установленные-пакеты">Как правильно удалить все установленные пакеты</h3>
<p>Установку Airflow производим под root для, что сделает airflow доступным под любым аккаунтом, так как исполняемые файлы Airflow будут устанавливаться в <code>/usr/local/bin</code>.</p>
<p>На свежей машине установлены только два python-пакета:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip list
</span></span><span style="display:flex;"><span>Package    Version
</span></span><span style="display:flex;"><span>---------- -------
</span></span><span style="display:flex;"><span>pip        21.0
</span></span><span style="display:flex;"><span>setuptools 39.2.0
</span></span></code></pre></div><p>Если необходимо удалить все python-пакеты, то сначала создаём файл со списком установленных пакетов:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip freeze &gt; requirements.txt
</span></span></code></pre></div><p>После чего удаляем все пакеты, используя их список из ранее созданного файла:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip uninstall -y -r requirements.txt
</span></span></code></pre></div><h2 id="установка">Установка</h2>
<p>Так как на целевой машине используется python 3.6, то перед установкой airflow скачиваем свежий ограничительный файл, это <a href="https://raw.githubusercontent.com/apache/airflow/constraints-2.0.1/constraints-3.6.txt">constraints-3.6.txt для Airflow 2.0.1</a>, и переносим на машину.</p>
<p>Так как версия установленного pip &gt; 20.2.4, то устанавливаем Airflow указывая опцию <code>--use-deprecated legacy-resolver</code> и актуальный файл <code>constraints.txt</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Обновляем pip</span>
</span></span><span style="display:flex;"><span>$ sudo pip3 install --upgrade pip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Устанавливаем wheel</span>
</span></span><span style="display:flex;"><span>$ sudo pip3 install wheel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sudo pip3 install apache-airflow<span style="color:#f92672">==</span>2.0.1 --use-deprecated legacy-resolver --constraint constraints-3.6.txt
</span></span><span style="display:flex;"><span>Looking in indexes: http://centos-main-reader:****@nexus.example.org:8081/repository/pypi/simple
</span></span><span style="display:flex;"><span>Collecting apache-airflow<span style="color:#f92672">==</span>2.0.1
</span></span><span style="display:flex;"><span>  Downloading http://nexus.example.org:8081/repository/pypi/packages/apache-airflow/2.0.1/apache_airflow-2.0.1-py3-none-any.whl <span style="color:#f92672">(</span>4.5 MB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>     |████████████████████████████████| 4.5 MB 61.9 MB/s
</span></span><span style="display:flex;"><span>Collecting cached-property<span style="color:#f92672">==</span>1.5.2
</span></span><span style="display:flex;"><span>  Downloading http://nexus.example.org:8081/repository/pypi/packages/cached-property/1.5.2/cached_property-1.5.2-py2.py3-none-any.whl <span style="color:#f92672">(</span>7.6 kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting iso8601<span style="color:#f92672">==</span>0.1.14
</span></span><span style="display:flex;"><span>  Downloading http://nexus.example.org:8081/repository/pypi/packages/iso8601/0.1.14/iso8601-0.1.14-py2.py3-none-any.whl <span style="color:#f92672">(</span>9.5 kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting psutil<span style="color:#f92672">==</span>5.8.0
</span></span><span style="display:flex;"><span>  Downloading http://nexus.example.org:8081/repository/pypi/packages/psutil/5.8.0/psutil-5.8.0-cp36-cp36m-manylinux2010_x86_64.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">291</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>     |████████████████████████████████| <span style="color:#ae81ff">291</span> kB 75.9 MB/s
</span></span><span style="display:flex;"><span>Collecting pendulum<span style="color:#f92672">==</span>2.1.2
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Successfully installed Babel-2.9.0 Flask-1.1.2 Flask-AppBuilder-3.1.1 Flask-Babel-1.0.0 Flask-Caching-1.9.0 Flask-JWT-Extended-3.25.1 Flask-Login-0.4.1 Flask-OpenID-1.2.5 Flask-SQLAlchemy-2.4.4 Flask-WTF-0.14.3 Jinja2-2.11.3 Mako-1.1.4 Markdown-3.3.3 MarkupSafe-1.1.1 PyJWT-1.7.1 PyYAML-5.4.1 Pygments-2.8.0 SQLAlchemy-1.3.23 SQLAlchemy-JSONField-1.0.0 SQLAlchemy-Utils-0.36.8 WTForms-2.3.3 Werkzeug-1.0.1 alembic-1.5.4 apache-airflow-2.0.1 apache-airflow-providers-ftp-1.0.1 apache-airflow-providers-http-1.1.0 apache-airflow-providers-imap-1.0.1 apache-airflow-providers-sqlite-1.0.1 apispec-3.3.2 argcomplete-1.12.2 attrs-20.3.0 cached-property-1.5.2 cattrs-1.0.0 certifi-2020.12.5 cffi-1.14.5 chardet-3.0.4 click-7.1.2 clickclick-20.10.2 colorama-0.4.4 colorlog-4.7.2 commonmark-0.9.1 connexion-2.7.0 croniter-0.3.37 cryptography-3.4.5 dataclasses-0.7 defusedxml-0.6.0 dill-0.3.3 dnspython-1.16.0 docutils-0.16 email-validator-1.1.2 graphviz-0.16 gunicorn-19.10.0 idna-2.10 importlib-metadata-1.7.0 importlib-resources-1.5.0 inflection-0.5.1 iso8601-0.1.14 itsdangerous-1.1.0 jsonschema-3.2.0 lazy-object-proxy-1.4.3 lockfile-0.12.2 marshmallow-3.10.0 marshmallow-enum-1.5.1 marshmallow-oneofschema-2.1.0 marshmallow-sqlalchemy-0.23.1 natsort-7.1.1 numpy-1.19.5 openapi-spec-validator-0.2.9 pandas-1.1.5 pendulum-2.1.2 pep562-1.0 prison-0.1.3 psutil-5.8.0 pycparser-2.20 pyrsistent-0.17.3 python-daemon-2.2.4 python-dateutil-2.8.1 python-editor-1.0.4 python-nvd3-0.15.0 python-slugify-4.0.1 python3-openid-3.2.0 pytz-2020.5 pytzdata-2020.1 requests-2.25.1 rich-9.2.0 setproctitle-1.2.2 six-1.15.0 swagger-ui-bundle-0.0.8 tabulate-0.8.7 tenacity-6.2.0 termcolor-1.1.0 text-unidecode-1.3 typing-3.7.4.3 typing-extensions-3.7.4.3 unicodecsv-0.14.1 urllib3-1.25.11 zipp-3.4.0
</span></span></code></pre></div><p>Устанавливаем дополнительные airflow-пакеты для работы с Hadoop:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip3 install apache-airflow<span style="color:#f92672">[</span>async,celery,crypto,jdbc,jenkins,hdfs,hive,ldap,password,postgres,rabbitmq,vertica<span style="color:#f92672">]</span> --use-deprecated legacy-resolver --constraint constraints-3.6.txt
</span></span><span style="display:flex;"><span>Looking in indexes: http://nx-pubrepo-reader:****@nexus.example.org:8081/repository/pypi/simple
</span></span><span style="display:flex;"><span>Requirement already satisfied: apache-airflow<span style="color:#f92672">[</span>async,celery,crypto,hdfs,hive,jdbc,jenkins,ldap,password,pig,p
</span></span><span style="display:flex;"><span>ostgres,rabbitmq,spark,sqoop,vertica<span style="color:#f92672">]</span> in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>2.0.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: requests<span style="color:#f92672">==</span>2.25.1 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constrain
</span></span><span style="display:flex;"><span>ts-3.6.txt <span style="color:#f92672">(</span>line 409<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>2.25.1<span style="color:#f92672">)</span>  
</span></span><span style="display:flex;"><span>Requirement already satisfied: Flask-Caching<span style="color:#f92672">==</span>1.9.0 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c const
</span></span><span style="display:flex;"><span>raints-3.6.txt <span style="color:#f92672">(</span>line 7<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>1.9.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: termcolor<span style="color:#f92672">==</span>1.1.0 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constrain
</span></span><span style="display:flex;"><span>ts-3.6.txt <span style="color:#f92672">(</span>line 458<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>1.1.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: apache-airflow-providers-sqlite<span style="color:#f92672">==</span>1.0.1 in /usr/local/lib/python3.6/site-packa
</span></span><span style="display:flex;"><span>ges <span style="color:#f92672">(</span>from -c constraints-3.6.txt <span style="color:#f92672">(</span>line 98<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>1.0.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: Flask<span style="color:#f92672">==</span>1.1.2 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constraints-3.6.txt <span style="color:#f92672">(</span>line 14<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>1.1.2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: tenacity<span style="color:#f92672">==</span>6.2.0 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constraints-3.6.txt <span style="color:#f92672">(</span>line 457<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>6.2.0<span style="color:#f92672">)</span>...
</span></span><span style="display:flex;"><span>Successfully installed Flask-Bcrypt-0.7.1 JPype1-1.2.1 JayDeBeApi-1.2.3 PyHive-0.6.3 amqp-2.6.1 apache-airflow-providers-apache-hdfs-1.0.1 apache-airflow-providers-apache-hive-1.0.1 apache-airflow-providers-apache-spark-1.0.1 apache-airflow-providers-celery-1.0.1 apache-airflow-providers-jdbc-1.0.1 apache-airflow-providers-jenkins-1.0.1 apache-airflow-providers-postgres-1.0.1 apache-airflow-providers-vertica-1.0.1 argparse-1.4.0 bcrypt-3.2.0 billiard-3.6.3.0 celery-4.4.7 eventlet-0.30.1 flower-0.9.7 future-0.18.2 gevent-21.1.2 greenlet-1.0.0 hmsclient-0.1.1 humanize-3.2.0 kombu-4.6.11 ldap3-2.9 multi-key-dict-2.0.3 pbr-5.5.1 prometheus-client-0.8.0 protobuf-3.14.0 psycopg2-binary-2.8.6 py4j-0.10.9 pyasn1-0.4.8 pyasn1-modules-0.2.8 pyspark-3.0.1 python-jenkins-1.7.0 python-ldap-3.3.1 sasl-0.2.1 snakebite-py3-3.0.5 thrift-0.13.0 thrift-sasl-0.4.2 tornado-6.1 vertica-python-1.0.1 vine-1.3.0 zope.event-4.5.0 zope.interface-5.2.0
</span></span></code></pre></div><p>Попробуем установить пакет &lsquo;apache-airflow[kerberos]&rsquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip install apache-airflow<span style="color:#f92672">[</span>kerberos<span style="color:#f92672">]</span> --use-deprecated legacy-resolver --constraint constraints-3.6.txt
</span></span><span style="display:flex;"><span>Looking in indexes: http://centos-main-reader:****@nexus.example.org:8081/repository/pypi/simple
</span></span><span style="display:flex;"><span>Requirement already satisfied: apache-airflow<span style="color:#f92672">[</span>kerberos<span style="color:#f92672">]</span> in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>2.0.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: croniter<span style="color:#f92672">==</span>0.3.36 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constrain
</span></span><span style="display:flex;"><span>ts-3.6.txt <span style="color:#f92672">(</span>line 109<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>0.3.36<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: cryptography<span style="color:#f92672">==</span>3.2.1 in /usr/local/lib64/python3.6/site-packages <span style="color:#f92672">(</span>from -c cons
</span></span><span style="display:flex;"><span>traints-3.6.txt <span style="color:#f92672">(</span>line 110<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>3.2.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Requirement already satisfied: iso8601<span style="color:#f92672">==</span>0.1.13 in /usr/local/lib/python3.6/site-packages <span style="color:#f92672">(</span>from -c constraints-3.6.txt <span style="color:#f92672">(</span>line 211<span style="color:#f92672">))</span> <span style="color:#f92672">(</span>0.1.13<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Building wheels <span style="color:#66d9ef">for</span> collected packages: pykerberos
</span></span><span style="display:flex;"><span>  Building wheel <span style="color:#66d9ef">for</span> pykerberos <span style="color:#f92672">(</span>setup.py<span style="color:#f92672">)</span> ... <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>  Created wheel <span style="color:#66d9ef">for</span> pykerberos: filename<span style="color:#f92672">=</span>pykerberos-1.2.1-cp36-cp36m-linux_x86_64.whl size<span style="color:#f92672">=</span><span style="color:#ae81ff">58013</span> sha256<span style="color:#f92672">=</span>54044550e3499adf6034c02788de75da7513b0d3f267c4088345e20062a79c57
</span></span><span style="display:flex;"><span>  Stored in directory: /root/.cache/pip/wheels/3f/67/bb/d23671c8719076ca13dd216b491ed5cea1b0494891aa9e7dba
</span></span><span style="display:flex;"><span>Successfully built pykerberos
</span></span><span style="display:flex;"><span>Installing collected packages: pykerberos, requests-kerberos
</span></span><span style="display:flex;"><span>Successfully installed pykerberos-1.2.1 requests-kerberos-0.12.0
</span></span></code></pre></div><p>Устанавливаем пакет &lsquo;python-ldap&rsquo; для возможности LDAP-аутентификации в FAB:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip install python-ldap
</span></span><span style="display:flex;"><span>Installing collected packages: python-ldap
</span></span><span style="display:flex;"><span>    Running setup.py install <span style="color:#66d9ef">for</span> python-ldap ... <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>Successfully installed python-ldap-3.3.1
</span></span></code></pre></div><ul>
<li>2021-02-18 при установке очередного экземпляра Airflow, выяснилось, что &lsquo;python-ldap&rsquo; устанавливается на одном из предыдущих этапах. Видимо разработчики внесли этот пакет в зависимости. Но пока установку этого пакета не убираю.</li>
</ul>
<p>Для организации мэппинга между группами в IPA и ролями в Airflow устанавливаем свежий модуль &lsquo;Flask-AppBuilder 3.2.0&rsquo;, в котором это реализовано. Не обращаем внимания на предупреждения о нарушении зависимостей:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip install Flask-AppBuilder<span style="color:#f92672">==</span>3.2.0
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Installing collected packages: Flask-AppBuilder
</span></span><span style="display:flex;"><span>  Attempting uninstall: Flask-AppBuilder
</span></span><span style="display:flex;"><span>    Found existing installation: Flask-AppBuilder 3.1.1
</span></span><span style="display:flex;"><span>    Uninstalling Flask-AppBuilder-3.1.1:
</span></span><span style="display:flex;"><span>      Successfully uninstalled Flask-AppBuilder-3.1.1
</span></span><span style="display:flex;"><span>ERROR: pip<span style="color:#960050;background-color:#1e0010">&#39;</span>s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
</span></span><span style="display:flex;"><span>apache-airflow 2.0.1 requires flask-appbuilder~<span style="color:#f92672">=</span>3.1.1, but you have flask-appbuilder 3.2.0 which is incompatible.
</span></span></code></pre></div><h2 id="настройка-airflow">Настройка Airflow</h2>
<h3 id="создание-типового-файла-airflowcfg">Создание типового файла <code>airflow.cfg</code></h3>
<p>Одноразово запускаем airflow для создания типового файла <code>/etc/airflow/airflow.cfg</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export AIRFLOW_HOME<span style="color:#f92672">=</span>/data/airflow
</span></span><span style="display:flex;"><span>export AIRFLOW_CONFIG<span style="color:#f92672">=</span>/etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo -E -u airflow /usr/local/bin/airflow webserver -p <span style="color:#ae81ff">8080</span>
</span></span></code></pre></div><p>Первый запуск Apache Airflow должен закончиться какой-нибудь ошибкой, например:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 18:39:48,191<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>cli_action_loggers.py:105<span style="color:#f92672">}</span> WARNING - Failed to log action with <span style="color:#f92672">(</span>sqlite3.Operation
</span></span><span style="display:flex;"><span>alError<span style="color:#f92672">)</span> no such table: log
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>SQL: INSERT INTO log <span style="color:#f92672">(</span>dttm, dag_id, task_id, event, execution_date, owner, extra<span style="color:#f92672">)</span> VALUES <span style="color:#f92672">(</span>?, ?, ?, ?, ?, ?,
</span></span><span style="display:flex;"><span> ?<span style="color:#f92672">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>parameters: <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;2021-01-28 15:39:48.187080&#39;</span>, None, None, <span style="color:#e6db74">&#39;cli_webserver&#39;</span>, None, <span style="color:#e6db74">&#39;airflow&#39;</span>, <span style="color:#e6db74">&#39;{&#34;host_name&#34;: &#34;ud
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">rvs-airf01p.example.org&#34;, &#34;full_command&#34;: &#34;[\&#39;</span>/usr/local/bin/airflow<span style="color:#ae81ff">\&#39;</span>, <span style="color:#ae81ff">\&#39;</span>webserver<span style="color:#ae81ff">\&#39;</span>, <span style="color:#ae81ff">\&#39;</span>-p<span style="color:#ae81ff">\&#39;</span>, <span style="color:#ae81ff">\&#39;</span>********<span style="color:#ae81ff">\&#39;</span><span style="color:#f92672">]</span><span style="color:#e6db74">&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(Background on this error at: http://sqlalche.me/e/13/e3q8)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  ____________       _____________
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> ____    |__( )_________  __/__  /________      __
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">____  /| |_  /__  ___/_  /_ __  /_  __ \_ | /| / /
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">___  ___ |  / _  /   _  __/ _  / / /_/ /_ |/ |/ /
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> _/_/  |_/_/  /_/    /_/    /_/  \____/____/|__/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[2021-01-28 18:39:48,223] {dagbag.py:440} INFO - Filling up the DagBag from /dev/null
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[2021-01-28 18:39:48,309] {manager.py:727} WARNING - No user yet created, use flask fab command to do it.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Traceback (most recent call last):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: dag
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[SQL: SELECT dag.dag_id AS dag_dag_id, dag.root_dag_id AS dag_root_dag_id, dag.is_paused AS dag_is_paused, dag.is_subdag AS dag_is_subdag, dag.is_active AS dag_is_active, dag.last_scheduler_run AS dag_last_scheduler_run, dag.last_pickled AS dag_last_pickled, dag.last_expired AS dag_last_expired, dag.scheduler_lock AS dag_scheduler_lock, dag.pickle_id AS dag_pickle_id, dag.fileloc AS dag_fileloc, dag.owners AS dag_owners, dag.description AS dag_description, dag.default_view AS dag_default_view, dag.schedule_interval AS dag_schedule_interval, dag.concurrency AS dag_concurrency, dag.has_task_concurrency_limits AS dag_has_task_concurrency_limits, dag.next_dagrun AS dag_next_dagrun, dag.next_dagrun_create_after AS dag_next_dagrun_create_after
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">FROM dag
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">WHERE dag.is_active = 1 OR dag.is_paused = 1]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(Background on this error at: http://sqlalche.me/e/13/e3q8)
</span></span></span></code></pre></div><p>Но в каталоге &lsquo;/etc/airflow&rsquo; должен появиться типовой файл &lsquo;airflow.cfg&rsquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo ls -al /etc/airflow
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">112</span>
</span></span><span style="display:flex;"><span>drwxr-s---    <span style="color:#ae81ff">2</span> airflow airflow   <span style="color:#ae81ff">185</span> Feb <span style="color:#ae81ff">18</span> 13:17 .
</span></span><span style="display:flex;"><span>drwxr-xr-x. <span style="color:#ae81ff">122</span> root    root     <span style="color:#ae81ff">8192</span> Feb <span style="color:#ae81ff">18</span> 11:37 ..
</span></span><span style="display:flex;"><span>-rw-r-----    <span style="color:#ae81ff">1</span> airflow airflow <span style="color:#ae81ff">38914</span> Feb <span style="color:#ae81ff">18</span> 13:17 airflow.cfg
</span></span><span style="display:flex;"><span>-rw-r-----    <span style="color:#ae81ff">1</span> root    airflow  <span style="color:#ae81ff">1720</span> Feb <span style="color:#ae81ff">18</span> 12:06 prod-airf1_prod-airf01p.crt
</span></span><span style="display:flex;"><span>-rw-r-----    <span style="color:#ae81ff">1</span> root    airflow  <span style="color:#ae81ff">1708</span> Feb <span style="color:#ae81ff">18</span> 12:06 prod-airf1_prod-airf01p.key
</span></span><span style="display:flex;"><span>-r--------    <span style="color:#ae81ff">1</span> root    airflow    <span style="color:#ae81ff">15</span> Jan <span style="color:#ae81ff">28</span> 22:51 psql-db.txt
</span></span><span style="display:flex;"><span>-r--------    <span style="color:#ae81ff">1</span> root    airflow    <span style="color:#ae81ff">27</span> Jan <span style="color:#ae81ff">28</span> 22:51 psql-pass.txt
</span></span></code></pre></div><p>В каталоге <code>/data/airflow</code> должен появиться типовой файл <code>webserver_config.py</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo ls -al /data/airflow
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>drwxr-x---  <span style="color:#ae81ff">5</span> airflow airflow   <span style="color:#ae81ff">93</span> Feb <span style="color:#ae81ff">18</span> 13:06 .
</span></span><span style="display:flex;"><span>drwxr-xr-x. <span style="color:#ae81ff">3</span> root    root      <span style="color:#ae81ff">21</span> Feb <span style="color:#ae81ff">18</span> 11:54 ..
</span></span><span style="display:flex;"><span>drwxr-s---+ <span style="color:#ae81ff">2</span> airflow airflow    <span style="color:#ae81ff">6</span> Feb <span style="color:#ae81ff">18</span> 11:54 dags
</span></span><span style="display:flex;"><span>drwxr-x---+ <span style="color:#ae81ff">3</span> airflow airflow   <span style="color:#ae81ff">23</span> Feb <span style="color:#ae81ff">18</span> 13:09 logs
</span></span><span style="display:flex;"><span>drwxr-s---+ <span style="color:#ae81ff">2</span> airflow airflow    <span style="color:#ae81ff">6</span> Feb <span style="color:#ae81ff">18</span> 11:54 plugins
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> airflow airflow <span style="color:#ae81ff">2564</span> Feb <span style="color:#ae81ff">18</span> 13:03 unittests.cfg
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> airflow airflow <span style="color:#ae81ff">4700</span> Feb <span style="color:#ae81ff">18</span> 13:03 webserver_config.py
</span></span></code></pre></div><h3 id="переключение-airflow-на-использование-postgresql">Переключение Airflow на использование PostgreSQL</h3>
<p>Делаем бэкап <code>/etc/airflow/airflow.cfg</code>, исправляем права на эти файлы, и исправляем/добавляем строки:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo cp /etc/airflow/airflow.cfg /etc/airflow/airflow.cfg.origin
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">640</span> /etc/airflow/airflow.cfg /etc/airflow/airflow.cfg.origin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^executor.*/executor = LocalExecutor/&#39;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^sql_alchemy_conn.*/sql_alchemy_conn = postgres+psycopg2:\/\/</span><span style="color:#66d9ef">$(</span>sudo cat /etc/airflow/psql-pass.txt<span style="color:#66d9ef">)</span><span style="color:#e6db74">@127.0.0.1\/</span><span style="color:#66d9ef">$(</span>sudo cat /etc/airflow/psql-db.txt<span style="color:#66d9ef">)</span><span style="color:#e6db74">/&#34;</span> /etc/airflow/airflow.cfg
</span></span></code></pre></div><p>В результате приведённой выше команды, в файле <code>/etc/airflow/airflow.cfg</code> будут исправлены две строки. Вторая строка, отвечающая за подключение к PostgreSQL, будет содержать пароль взятый из ранее созданного файла, и не похожий на тот, что можно наблюдать в следующем примере:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>core<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>executor <span style="color:#f92672">=</span> LocalExecutor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sql_alchemy_conn <span style="color:#f92672">=</span> postgres+psycopg2://airf-user:xxxxxxxxx@127.0.0.1/airf_metadata
</span></span></code></pre></div><p>Отключение загрузки example DAGs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^load_examples = True/load_examples = False/&#39;</span> /etc/airflow/airflow.cfg
</span></span></code></pre></div><p>Однократная инициализация базы данных Airflow:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>export AIRFLOW_HOME<span style="color:#f92672">=</span>/data/airflow
</span></span><span style="display:flex;"><span>export AIRFLOW_CONFIG<span style="color:#f92672">=</span>/etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo -E -u airflow airflow db init
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>DB: postgres+psycopg2://airf_user:***@127.0.0.1/airf_metadata
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:07,021<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>db.py:678<span style="color:#f92672">}</span> INFO - Creating tables
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Context impl PostgresqlImpl.
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Will assume transactional DDL.
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Running upgrade  -&gt; e3a246e0dc1, current schema
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Running upgrade e3a246e0dc1 -&gt; 1507a7289a2f, create is_encrypted
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Running upgrade 1507a7289a2f -&gt; 13eb55f81627, maintain history <span style="color:#66d9ef">for</span> compati
</span></span><span style="display:flex;"><span>bility with earlier migrations
</span></span><span style="display:flex;"><span>INFO  <span style="color:#f92672">[</span>alembic.runtime.migration<span style="color:#f92672">]</span> Running upgrade 13eb55f81627 -&gt; 338e90f54d61, More logging into task_instance
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:09,165<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>manager.py:727<span style="color:#f92672">}</span> WARNING - No user yet created, use flask fab command to <span style="color:#66d9ef">do</span> it.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,349<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>migration.py:517<span style="color:#f92672">}</span> INFO - Running upgrade 2c6edca13270 -&gt; 61ec73d9401f, Add description field to connection
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,351<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>migration.py:517<span style="color:#f92672">}</span> INFO - Running upgrade 61ec73d9401f -&gt; 64a7d6477aae, fix description field in connection to be text
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,353<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>migration.py:517<span style="color:#f92672">}</span> INFO - Running upgrade 64a7d6477aae -&gt; e959f08ac86c, Change field in DagCode to MEDIUMTEXT <span style="color:#66d9ef">for</span> MySql
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,524<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>dagbag.py:440<span style="color:#f92672">}</span> INFO - Filling up the DagBag from /data/airflow/dags
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,554<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>example_kubernetes_executor_config.py:174<span style="color:#f92672">}</span> WARNING - Could not import DAGs in example_kubernetes_executor_config.py: No module named <span style="color:#e6db74">&#39;kubernetes&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,554<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>example_kubernetes_executor_config.py:175<span style="color:#f92672">}</span> WARNING - Install kubernetes dependencies with: pip install apache-airflow<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;cncf.kubernetes&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,706<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>dag.py:2266<span style="color:#f92672">}</span> INFO - Setting next_dagrun <span style="color:#66d9ef">for</span> example_subdag_operator.section-1 to None
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>2021-01-28 19:11:12,707<span style="color:#f92672">]</span> <span style="color:#f92672">{</span>dag.py:2266<span style="color:#f92672">}</span> INFO - Setting next_dagrun <span style="color:#66d9ef">for</span> example_subdag_operator.section-2 to None
</span></span><span style="display:flex;"><span>Initialization <span style="color:#66d9ef">done</span>
</span></span></code></pre></div><h3 id="настройка-https-для-web-ui">Настройка HTTPS для Web UI</h3>
<p>В <code>/etc/airflow/airflow.cfg</code> добавляем строки, указывающие использовать https и ранее созданные ключ и сертификат:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>webserver<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>base_url <span style="color:#f92672">=</span> https://prod-airf1.example.org:8080
</span></span><span style="display:flex;"><span>web_server_port <span style="color:#f92672">=</span> <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>web_server_ssl_cert <span style="color:#f92672">=</span> /etc/airflow/prod-airf1_prod-airf01p.crt
</span></span><span style="display:flex;"><span>web_server_ssl_key <span style="color:#f92672">=</span> /etc/airflow/prod-airf1_prod-airf01p.key
</span></span></code></pre></div><p>Для этого выполняем следующий скрипт, но <strong>важно помнить, что переменную URL мы берём из переменной ALIASHOSTNAME, которая была определена на этапе добавления сервисов в IPA</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>URL<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>ALIASHOSTNAME<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CRT<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ls *.crt<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>KEY<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ls *.key<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^base_url.*/base_url=https:\/\/</span><span style="color:#e6db74">${</span>URL<span style="color:#e6db74">}</span><span style="color:#e6db74">\:8080/&#34;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^web_server_ssl_cert.*/web_server_ssl_cert = \/etc\/airflow\/</span><span style="color:#e6db74">${</span>CRT<span style="color:#e6db74">}</span><span style="color:#e6db74">/&#34;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^web_server_ssl_key.*/web_server_ssl_key = \/etc\/airflow\/</span><span style="color:#e6db74">${</span>KEY<span style="color:#e6db74">}</span><span style="color:#e6db74">/&#34;</span> /etc/airflow/airflow.cfg
</span></span></code></pre></div><h3 id="настройка-ldap-аутентификации">Настройка LDAP-аутентификации</h3>
<p>После создания в Каталоге отдельного системного пользователя для подключения к LDAP и всех необходимых групп пользователей, заполняем в <code>/data/airflow/webserver_config.py</code> следующей информацией. <strong>Важно помнить, что некоторые переменные в этом скрипте берутся из ранее проделанных этапов этой инструкции, а некоторые необходимо переопределить</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Сохраняем оригинальный конфиг.</span>
</span></span><span style="display:flex;"><span>mv /data/airflow/webserver_config.py /data/airflow/webserver_config.py.origin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Эта переменная берётся из переменной GROUPNAME, которую</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># определили на этапе создания групп в IPA:</span>
</span></span><span style="display:flex;"><span>IPA_AIRFLOW_GROUP<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>GROUPNAME<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Переменные определяющие системную УЗ для подключения к LDAP.</span>
</span></span><span style="display:flex;"><span>BIND_USER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;uid=binddn_airflow,cn=sysaccounts,cn=etc,dc=example,dc=org&#34;</span>
</span></span><span style="display:flex;"><span>BIND_PASSWORD<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xxxxxxxxxxxxxxxx&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Заполняем новый конфиг данными.</span>
</span></span><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF &gt; /data/airflow/webserver_config.py
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import os
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">from flask_appbuilder.security.manager import AUTH_LDAP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">basedir = os.path.abspath(os.path.dirname(__file__))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">WTF_CSRF_ENABLED = True
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_TYPE = AUTH_LDAP
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Uncomment to setup Full admin role name
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_ROLE_ADMIN = &#39;Admin&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Uncomment to setup Public role name, no authentication needed
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#AUTH_ROLE_PUBLIC = &#39;Public&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Will allow user self registration
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_USER_REGISTRATION = True
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># The default user self registration role
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_USER_REGISTRATION_ROLE = &#34;Viewer&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_SERVER = &#39;ldaps://prod-ipa01.example.org ldaps://prod-ipa02.example.org ldaps://prod-ipa03.example.org&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_SEARCH = &#39;cn=users,cn=accounts,dc=example,dc=org&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_GROUP_FIELD = &#39;memberOf&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_SEARCH_FILTER = &#39;(memberOf=cn=${IPA_AIRFLOW_GROUP},cn=groups,cn=accounts,dc=example,dc=org)&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_BIND_USER = &#39;$BIND_USER&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_BIND_PASSWORD = &#39;$BIND_PASSWORD&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_UID_FIELD = &#39;uid&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#AUTH_LDAP_USE_TLS = True
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_ALLOW_SELF_SIGNED = True
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_LDAP_TLS_CACERTFILE = &#39;/etc/ipa/ca.crt&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_ROLES_SYNC_AT_LOGIN = True
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AUTH_ROLES_MAPPING = {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;cn=${IPA_AIRFLOW_GROUP}_viewers,cn=groups,cn=accounts,dc=example,dc=org&#34;: [&#34;Viewer&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;cn=${IPA_AIRFLOW_GROUP}_users,cn=groups,cn=accounts,dc=example,dc=org&#34;: [&#34;User&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;cn=${IPA_AIRFLOW_GROUP}_ops,cn=groups,cn=accounts,dc=example,dc=org&#34;: [&#34;Op&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#34;cn=${IPA_AIRFLOW_GROUP}_admin,cn=groups,cn=accounts,dc=example,dc=org&#34;: [&#34;Admin&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">PERMANENT_SESSION_LIFETIME = 1800
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>Логгирование работы LDAP во Flask&rsquo;е можно включить через изменение опции &lsquo;fab_logging_level = WARN&rsquo; в /etc/airflow/airflow.cfg. Включение уровня DEBUG поможет отладке.</p>
<p>Некоторые моменты:</p>
<ul>
<li>Попытавшись использовать для одной УЗ роль &lsquo;Public&rsquo; я столкнулся с тем, что пользователь с этой ролью не может войти в Airflow. Web-браузер показывает ошибку перенаправления на самого себя (или как там правильно). Именно поэтому &lsquo;AUTH_USER_REGISTRATION_ROLE = &ldquo;Viewer&rdquo;&rsquo;, а не &ldquo;Public&rdquo;, чтобы свежезарегистрировавшийся пользователь смог войти в Airflow.</li>
<li>С другой стороны, возможно, вообще выключить эту опцию, так как роли берутся из IPA.</li>
<li>Попробовал отключить эту опцию и новым пользователям, кроме роли из IPA, стала назначаться роль &lsquo;Public&rsquo;, что в общем не критично. В общем, нет особой разницы между включением и отключением этой опции при подключённой LDAP-авторизации.</li>
</ul>
<h3 id="попытка-настройки-kerberos">Попытка настройки Kerberos</h3>
<p>Добавляем systemd unit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF | sudo tee /etc/systemd/system/airflow-kerberos.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Unit]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Description=Airflow kerberos ticket renewer
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">After=network.target airflow-webserver.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#Wants=postgresql-13.service mysql.service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Service]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EnvironmentFile=/etc/sysconfig/airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">User=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Group=airflow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Type=simple
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ExecStart=/usr/local/bin/airflow kerberos
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Restart=on-failure
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">RestartSec=5s
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">SyslogIdentifier=airf-krb
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[Install]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">WantedBy=multi-user.target
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>Не забываем:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl daemon-reload
</span></span></code></pre></div><p>Получаем Kerberos keytab-файл:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># При необходимости получаем kerbros-билет:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#kinit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa service-add airflow/<span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>sudo ipa-getkeytab -s prod-ipa01p.example.org -p airflow/<span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span> -k /etc/airflow/airflow_<span style="color:#66d9ef">$(</span>hostname -s<span style="color:#66d9ef">)</span>.keytab
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">660</span> /etc/airflow/airflow_<span style="color:#66d9ef">$(</span>hostname -s<span style="color:#66d9ef">)</span>.keytab
</span></span></code></pre></div><p>Забыл проверить, надо ли получать для себя в IPA разрешения для только что созданного сервиса: &ldquo;Разрешено создавать таблицу ключей&rdquo; и &ldquo;Разрешено получать таблицу ключей&rdquo;. Или я, как админ, смог получить keytab без таковых.</p>
<p>В файле <code>/etc/airflow/airflow.cfg</code> добавляем/изменяем строки:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^security.*/security = kerberos/&#39;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^ccache.*/ccache = \/tmp\/airflow_krb5_ccache/&#39;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^principal.*/principal = airflow\/</span><span style="color:#66d9ef">$(</span>hostname<span style="color:#66d9ef">)</span><span style="color:#e6db74">/&#34;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^reinit_frequency.*/reinit_frequency = 3600/&#39;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#39;s/^kinit_path.*/kinit_path = kinit/&#39;</span> /etc/airflow/airflow.cfg
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#e6db74">&#34;s/^keytab.*/keytab = \/etc\/airflow\/airflow_</span><span style="color:#66d9ef">$(</span>hostname -s<span style="color:#66d9ef">)</span><span style="color:#e6db74">.keytab/&#34;</span> /etc/airflow/airflow.cfg
</span></span></code></pre></div><p>Перезапускаем и проверяем:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl start airflow-kerberos
</span></span><span style="display:flex;"><span>sudo klist -c /tmp/airflow_krb5_ccache
</span></span><span style="display:flex;"><span>  Ticket cache: FILE:/tmp/airflow_krb5_ccache
</span></span><span style="display:flex;"><span>  Default principal: airflow/prod-airf01p.example.org@example.org
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Valid starting       Expires              Service principal
</span></span><span style="display:flex;"><span>  02/16/2021 13:37:08  02/17/2021 13:37:08  krbtgt/example.org@example.org
</span></span><span style="display:flex;"><span>          renew <span style="color:#66d9ef">until</span> 02/19/2021 01:37:06
</span></span></code></pre></div><p>Из-за установленного в <code>/etc/airflow/airflow.cfg</code> параметра &lsquo;reinit_frequency = 3600&rsquo;, через один час тикет будет обновлён.</p>
<p>Далее надо разобраться с добавлением строк в &lsquo;core-site.xml&rsquo;, как описано в <a href="https://airflow.apache.org/docs/apache-airflow/stable/security/kerberos.html#hadoop">https://airflow.apache.org/docs/apache-airflow/stable/security/kerberos.html#hadoop</a>.</p>
<h2 id="завершение">Завершение</h2>
<p>Запуск Airflow:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl daemon-reload <span style="color:#75715e"># На всякий случай</span>
</span></span><span style="display:flex;"><span>systemctl enable --now airflow-<span style="color:#f92672">{</span>webserver,scheduler,kerberos<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>В течении пары минут должен подняться Web-интерфейс по ранее определённому адресу <a href="https://prod-airf1.example.org:8080">https://prod-airf1.example.org:8080</a>.</p>
<p>Закидываем один тестовый DAG:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo cp /usr/local/lib/python3.6/site-packages/airflow/example_dags/example_bash_operator.py /data/airflow/dags/
</span></span></code></pre></div><p>По умолчанию, сканирование каталога с DAG&rsquo;ами выполняется каждые пять минут, поэтому придётся немного подождать момента появления нового DAG&rsquo;а в списке DAG&rsquo;ов, или переопределить этот параметр &lsquo;dag_dir_list_interval&rsquo;.</p>
<p>После появления тестового DAG&rsquo;а, его необходимо включить, а потом запустить. Успешное выполнение выглядит так:
<img src="/img/ustanovka-apache-airflow-2-freeipa-apache-hadoop-scenarii-udaleniya/airflowexampletask.png" alt="AirfowExampleTask"></p>
<p>Можно считать, что Airflow установлен.</p>
<h2 id="почти-полное-удаление-если-потребуется">Почти полное удаление, если потребуется</h2>
<p>Выполняем под <code>sudo su</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl disable --now airflow-<span style="color:#f92672">{</span>webserver,scheduler,kerberos<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>rm -f /etc/systemd/system/airflow-*.service
</span></span><span style="display:flex;"><span>systemctl daemon-reload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ID<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>getcert list|grep -3 <span style="color:#e6db74">&#39;/etc/airflow&#39;</span> | grep ID | grep -o <span style="color:#e6db74">&#39;[[:digit:]]*&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>ipa-getcert stop-tracking -i <span style="color:#e6db74">${</span>ID<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rm -rf /etc/airflow /data/airflow /var/log/airflow
</span></span><span style="display:flex;"><span>rm -f /etc/sysconfig/airflow /etc/rsyslog.d/airf-*.conf /etc/sudoers.d/airflow
</span></span><span style="display:flex;"><span>sed -i <span style="color:#e6db74">&#39;/airflow/d&#39;</span> /etc/logrotate.d/syslog
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pip freeze &gt; requirements.txt
</span></span><span style="display:flex;"><span>pip uninstall -y -r requirements.txt
</span></span><span style="display:flex;"><span>rm -f requirements.txt
</span></span><span style="display:flex;"><span>rsync -av /usr/local/lib/python3.6/site-packages/pip* /root/tmp/
</span></span><span style="display:flex;"><span>rm -rf /usr/local/lib/python3.6/site-packages/*
</span></span><span style="display:flex;"><span>rsync -av /root/tmp/pip* /usr/local/lib/python3.6/site-packages/
</span></span><span style="display:flex;"><span>rm -rf /root/tmp/pip*
</span></span><span style="display:flex;"><span>rm -rf /root/.cache/pip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>userdel -r airflow
</span></span></code></pre></div><p>Удаление PostgreSQL базы и пользователя:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>DBNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf_metadata&#34;</span>
</span></span><span style="display:flex;"><span>DBUSER<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf_user&#34;</span>
</span></span><span style="display:flex;"><span>sudo -u postgres psql -c <span style="color:#e6db74">&#34;DROP DATABASE </span><span style="color:#e6db74">${</span>DBNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">;&#34;</span>
</span></span><span style="display:flex;"><span>sudo -u postgres psql -c <span style="color:#e6db74">&#34;DROP USER </span><span style="color:#e6db74">${</span>DBUSER<span style="color:#e6db74">}</span><span style="color:#e6db74">;&#34;</span>
</span></span></code></pre></div><p>Удаление объектов из FreeIPA из-под обычного пользователя. <strong>Важно помнить, что необходимо поменять некоторые переменные перед использованием этого скрипта</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># При необходимости получаем kerberos-тикет:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#kinit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Меняем значение переменных:</span>
</span></span><span style="display:flex;"><span>ALIAS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;airf1&#34;</span>
</span></span><span style="display:flex;"><span>IPAGROUP<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;prod_airflow_airf1&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ALIASHOSTNAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ALIAS<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">${</span>DOMAIN<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>SHORTHOSTNAME<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>hostname -s<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>DOMAIN<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>hostname -d<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>DOMAINCAPS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>echo <span style="color:#66d9ef">$(</span>hostname -d<span style="color:#66d9ef">)</span>|tr <span style="color:#f92672">[</span>:lower:<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>:upper:<span style="color:#f92672">]</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa dnsrecord-del $DOMAIN $ALIAS --cname-rec<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa service-del HTTP/<span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span>@<span style="color:#e6db74">${</span>DOMAINCAPS<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ipa service-del airflow/<span style="color:#e6db74">${</span>HOSTNAME<span style="color:#e6db74">}</span>@<span style="color:#e6db74">${</span>DOMAINCAPS<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Удаляем группы из IPA:</span>
</span></span><span style="display:flex;"><span>ipa group-del <span style="color:#e6db74">${</span>IPAGROUP<span style="color:#e6db74">}</span>_admins
</span></span><span style="display:flex;"><span>ipa group-del <span style="color:#e6db74">${</span>IPAGROUP<span style="color:#e6db74">}</span>_ops
</span></span><span style="display:flex;"><span>ipa group-del <span style="color:#e6db74">${</span>IPAGROUP<span style="color:#e6db74">}</span>_users
</span></span><span style="display:flex;"><span>ipa group-del <span style="color:#e6db74">${</span>IPAGROUP<span style="color:#e6db74">}</span>_viewers
</span></span><span style="display:flex;"><span>ipa group-del <span style="color:#e6db74">${</span>IPAGROUP<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Вручную отозвать во FreeIPA сертификат из host-объекта.</span>
</span></span></code></pre></div><p>Остались не удалены:</p>
<ol>
<li>TLS-сертификат из host-объекта IPA.</li>
<li>Установленный PostgreSQL.</li>
<li>Некоторое количество yum-пакетов установленных через:</li>
</ol>
<ul>
<li><code>sudo yum -y groupinstall &quot;Development Tools&quot;</code></li>
<li><code>sudo yum -y install python3-devel cyrus-sasl cyrus-sasl-devel libffi-devel krb5-devel</code></li>
</ul>

	
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy;&nbsp;2009&nbsp;&ndash;&nbsp;2024 Evgeny Nifantyev <br /><a href="https://t.me/debuntu_ru">Telegram</a><br> All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="/js/main.min.73be0e798cb328decc7b6abbe26f2641a14dea3bf1d77a6f1ca067d3ab39374b.js" integrity="sha256-c74OeYyzKN7Me2q74m8mQaFN6jvx13pvHKBn06s5N0s=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>